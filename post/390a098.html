<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css" integrity="sha256-jTIdiMuX/e3DGJUGwl3pKSxuc6YOuqtJYkM0bGQESA4=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"tigercoll.top","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.10.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>



<link rel="canonical" href="https://tigercoll.top/post/390a098.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://tigercoll.top/post/390a098.html","path":"post/390a098.html","title":"Day002：网络与协议基础 - 以太网、MAC 与 ARP"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Day002：网络与协议基础 - 以太网、MAC 与 ARP | Tigercoll's Blog</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Tigercoll's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>
	
      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%A6%E4%B9%A0%E7%9B%AE%E6%A0%87"><span class="nav-number">1.</span> <span class="nav-text">学习目标</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%A6%E4%B9%A0%E5%86%85%E5%AE%B9"><span class="nav-number">2.</span> <span class="nav-text">学习内容</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%EF%B8%8F%E2%83%A3-%E4%BB%A5%E5%A4%AA%E7%BD%91%EF%BC%88Ethernet%EF%BC%89%E5%9F%BA%E7%A1%80"><span class="nav-number">2.1.</span> <span class="nav-text">1️⃣ 以太网（Ethernet）基础</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2%EF%B8%8F%E2%83%A3-MAC-%E5%9C%B0%E5%9D%80%E8%AF%A6%E8%A7%A3"><span class="nav-number">2.2.</span> <span class="nav-text">2️⃣ MAC 地址详解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3%EF%B8%8F%E2%83%A3-ARP-%E5%8D%8F%E8%AE%AE%EF%BC%88Address-Resolution-Protocol%EF%BC%89"><span class="nav-number">2.3.</span> <span class="nav-text">3️⃣ ARP 协议（Address Resolution Protocol）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4%EF%B8%8F%E2%83%A3-%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-number">2.4.</span> <span class="nav-text">4️⃣ 交换机工作原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5%EF%B8%8F%E2%83%A3-ARP-%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98%EF%BC%88%E7%90%86%E8%AE%BA%EF%BC%89"><span class="nav-number">2.5.</span> <span class="nav-text">5️⃣ ARP 安全问题（理论）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E8%B7%B5%E4%BB%BB%E5%8A%A1%EF%BC%88%E5%90%88%E6%B3%95%E6%8E%88%E6%9D%83%E8%8C%83%E5%9B%B4%E5%86%85%EF%BC%89"><span class="nav-number">3.</span> <span class="nav-text">实践任务（合法授权范围内）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%93%A6-%E4%BB%BB%E5%8A%A1%E5%87%86%E5%A4%87%EF%BC%9A%E5%AE%89%E8%A3%85-Wireshark"><span class="nav-number">3.1.</span> <span class="nav-text">📦 任务准备：安装 Wireshark</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%8E%AF-%E4%BB%BB%E5%8A%A1-1-%E4%BD%BF%E7%94%A8-Wireshark-%E6%8A%93%E5%8F%96%E6%9C%AC%E5%9C%B0-ARP-%E6%B5%81%E9%87%8F"><span class="nav-number">3.2.</span> <span class="nav-text">🎯 任务 1: 使用 Wireshark 抓取本地 ARP 流量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%93%8A-ARP-%E8%AF%B7%E6%B1%82%E5%8C%85%E5%AD%97%E6%AE%B5%E6%A0%87%E6%B3%A8"><span class="nav-number">3.3.</span> <span class="nav-text">📊 ARP 请求包字段标注</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%93%8A-ARP-%E5%BA%94%E7%AD%94%E5%8C%85%E5%AD%97%E6%AE%B5%E6%A0%87%E6%B3%A8"><span class="nav-number">3.4.</span> <span class="nav-text">📊 ARP 应答包字段标注</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%8E%AF-%E4%BB%BB%E5%8A%A1-2-%E8%A7%82%E5%AF%9F-ARP-%E7%BC%93%E5%AD%98%EF%BC%88%E5%B7%B2%E5%AE%8C%E6%88%90%EF%BC%89"><span class="nav-number">3.5.</span> <span class="nav-text">🎯 任务 2: 观察 ARP 缓存（已完成）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B7%A9%E5%9B%BA%E7%BB%83%E4%B9%A0%EF%BC%88%E9%A2%98%E4%B8%8E%E5%A4%8D%E7%9B%98%EF%BC%89"><span class="nav-number">4.</span> <span class="nav-text">巩固练习（题与复盘）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%84%E4%BC%B0%E6%A0%87%E5%87%86%EF%BC%88%E8%BE%BE%E6%88%90%E5%88%A4%E5%AE%9A%EF%BC%89"><span class="nav-number">5.</span> <span class="nav-text">评估标准（达成判定）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%A6%E4%B9%A0%E6%88%90%E6%9E%9C%E8%BE%BE%E6%88%90%E6%83%85%E5%86%B5%EF%BC%88%E7%94%B1%E5%AD%A6%E4%B9%A0%E8%80%85%E5%A1%AB%E5%86%99%EF%BC%89"><span class="nav-number">6.</span> <span class="nav-text">学习成果达成情况（由学习者填写）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%93%8B-%E5%AE%9E%E8%B7%B5%E4%BB%BB%E5%8A%A1%E5%AE%8C%E6%88%90%E6%83%85%E5%86%B5"><span class="nav-number">6.1.</span> <span class="nav-text">📋 实践任务完成情况</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%93%9D-%E5%B7%A9%E5%9B%BA%E7%BB%83%E4%B9%A0%E7%AD%94%E6%A1%88"><span class="nav-number">6.2.</span> <span class="nav-text">📝 巩固练习答案</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%9C%85-%E7%BB%93%E8%AE%BA%E4%B8%8E%E5%8F%8D%E6%80%9D"><span class="nav-number">6.3.</span> <span class="nav-text">✅ 结论与反思</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1%EF%B8%8F%E2%83%A3-%E2%9A%A0%EF%B8%8F-ARP-%E6%97%A0%E8%AE%A4%E8%AF%81%EF%BC%8C%E6%98%93%E5%8F%97%E6%AC%BA%E9%AA%97%E6%94%BB%E5%87%BB"><span class="nav-number">7.</span> <span class="nav-text">1️⃣ ⚠️ ARP 无认证，易受欺骗攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88-ARP-%E5%AE%B9%E6%98%93%E8%A2%AB%E6%AC%BA%E9%AA%97%EF%BC%9F"><span class="nav-number">7.1.</span> <span class="nav-text">为什么 ARP 容易被欺骗？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B8%E5%9E%8B%E6%94%BB%E5%87%BB%E5%9C%BA%E6%99%AF%EF%BC%9AARP-%E6%AC%BA%E9%AA%97-x2F-%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB"><span class="nav-number">7.2.</span> <span class="nav-text">典型攻击场景：ARP 欺骗&#x2F;中间人攻击</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%EF%B8%8F%E2%83%A3-%F0%9F%9B%A1%EF%B8%8F-%E5%85%B3%E9%94%AE%E8%AE%BE%E5%A4%87%E5%BA%94%E4%BD%BF%E7%94%A8%E9%9D%99%E6%80%81-ARP"><span class="nav-number">8.</span> <span class="nav-text">2️⃣ 🛡️ 关键设备应使用静态 ARP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E9%9D%99%E6%80%81-ARP%EF%BC%9F"><span class="nav-number">8.1.</span> <span class="nav-text">什么是静态 ARP？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E8%AE%BE%E7%BD%AE%E9%9D%99%E6%80%81-ARP%EF%BC%9F"><span class="nav-number">8.2.</span> <span class="nav-text">如何设置静态 ARP？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%94%E8%AF%A5%E5%AF%B9%E5%93%AA%E4%BA%9B%E8%AE%BE%E5%A4%87%E8%AE%BE%E7%BD%AE%E9%9D%99%E6%80%81-ARP%EF%BC%9F"><span class="nav-number">8.3.</span> <span class="nav-text">应该对哪些设备设置静态 ARP？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81-ARP-%E7%9A%84%E5%B1%80%E9%99%90%E6%80%A7"><span class="nav-number">8.4.</span> <span class="nav-text">静态 ARP 的局限性</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3%EF%B8%8F%E2%83%A3-%F0%9F%94%8D-%E5%BC%82%E5%B8%B8-ARP-%E6%B5%81%E9%87%8F%E5%8F%AF%E8%83%BD%E6%98%AF%E6%94%BB%E5%87%BB%E4%BF%A1%E5%8F%B7"><span class="nav-number">9.</span> <span class="nav-text">3️⃣ 🔍 异常 ARP 流量可能是攻击信号</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E6%A3%80%E6%B5%8B%E5%BC%82%E5%B8%B8-ARP-%E6%B5%81%E9%87%8F%EF%BC%9F"><span class="nav-number">9.1.</span> <span class="nav-text">如何检测异常 ARP 流量？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%9A%A8-%E5%8F%AF%E7%96%91%E4%BF%A1%E5%8F%B7-1%EF%BC%9A%E9%A2%91%E7%B9%81%E7%9A%84-ARP-%E8%AF%B7%E6%B1%82-x2F-%E5%BA%94%E7%AD%94"><span class="nav-number">9.2.</span> <span class="nav-text">🚨 可疑信号 1：频繁的 ARP 请求&#x2F;应答</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%9A%A8-%E5%8F%AF%E7%96%91%E4%BF%A1%E5%8F%B7-2%EF%BC%9AMAC-%E5%9C%B0%E5%9D%80%E9%A2%91%E7%B9%81%E5%8F%98%E5%8C%96"><span class="nav-number">9.3.</span> <span class="nav-text">🚨 可疑信号 2：MAC 地址频繁变化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%9A%A8-%E5%8F%AF%E7%96%91%E4%BF%A1%E5%8F%B7-3%EF%BC%9AGratuitous-ARP%EF%BC%88%E5%85%8D%E8%B4%B9-ARP%EF%BC%89%E6%BB%A5%E7%94%A8"><span class="nav-number">9.4.</span> <span class="nav-text">🚨 可疑信号 3：Gratuitous ARP（免费 ARP）滥用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%9A%A8-%E5%8F%AF%E7%96%91%E4%BF%A1%E5%8F%B7-4%EF%BC%9AARP-%E6%89%AB%E6%8F%8F"><span class="nav-number">9.5.</span> <span class="nav-text">🚨 可疑信号 4：ARP 扫描</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%92%A1-%E7%BB%BC%E5%90%88%E9%98%B2%E6%8A%A4%E5%BB%BA%E8%AE%AE"><span class="nav-number">10.</span> <span class="nav-text">💡 综合防护建议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%AA%E4%BA%BA-x2F-%E5%B0%8F%E5%9E%8B%E7%BD%91%E7%BB%9C"><span class="nav-number">10.1.</span> <span class="nav-text">个人&#x2F;小型网络</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C"><span class="nav-number">10.2.</span> <span class="nav-text">企业网络</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Wireshark-%E6%A3%80%E6%B5%8B%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5"><span class="nav-number">10.3.</span> <span class="nav-text">Wireshark 检测命令速查</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%8E%AF-%E5%AE%9E%E6%88%98%E9%AA%8C%E8%AF%81%EF%BC%88%E4%BB%85%E5%9C%A8%E6%8E%88%E6%9D%83%E9%9D%B6%E5%9C%BA%EF%BC%89"><span class="nav-number">11.</span> <span class="nav-text">🎯 实战验证（仅在授权靶场）</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Tigercoll"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Tigercoll</p>
  <div class="site-description" itemprop="description">万丈高楼平地起,勿在浮沙筑高台</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives">
          <span class="site-state-item-count">82</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories">
        <span class="site-state-item-count">40</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags">
        <span class="site-state-item-count">75</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Tigercoll" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Tigercoll" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tigercoll.top/post/390a098.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Tigercoll">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tigercoll's Blog">
      <meta itemprop="description" content="万丈高楼平地起,勿在浮沙筑高台">
    </span>
    
    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Day002：网络与协议基础 - 以太网、MAC 与 ARP | Tigercoll's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Day002：网络与协议基础 - 以太网、MAC 与 ARP
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-12-26 17:05:24" itemprop="dateCreated datePublished" datetime="2025-12-26T17:05:24+08:00">2025-12-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">网络安全</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>Day002：网络与协议基础 - 以太网、MAC 与 ARP</p>
<ul>
<li>日期：2025-12-26</li>
<li>周次：第 1 周</li>
</ul>
<h2 id="学习目标"><a href="#学习目标" class="headerlink" title="学习目标"></a>学习目标</h2><ul>
<li>理解二层寻址（MAC）与 ARP 的工作流程</li>
<li>认识广播域与交换机学习机制（理论）</li>
</ul>
<span id="more"></span>

<h2 id="学习内容"><a href="#学习内容" class="headerlink" title="学习内容"></a>学习内容</h2><h3 id="1️⃣-以太网（Ethernet）基础"><a href="#1️⃣-以太网（Ethernet）基础" class="headerlink" title="1️⃣ 以太网（Ethernet）基础"></a>1️⃣ 以太网（Ethernet）基础</h3><p><strong>以太网</strong>是最常用的局域网技术，工作在 OSI 的数据链路层（第 2 层）。</p>
<p><strong>以太网帧结构：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">┌──────────────┬──────────────┬──────┬─────────┬─────┐</span><br><span class="line">│ 目标MAC地址  │ 源MAC地址    │ 类型 │ 数据    │ FCS │</span><br><span class="line">│   6字节      │   6字节      │2字节 │46-1500字节│4字节│</span><br><span class="line">└──────────────┴──────────────┴──────┴─────────┴─────┘</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>类型字段</strong>：0x0800 &#x3D; IPv4，0x0806 &#x3D; ARP</li>
<li><strong>FCS</strong>：帧校验序列，检测传输错误</li>
</ul>
<h3 id="2️⃣-MAC-地址详解"><a href="#2️⃣-MAC-地址详解" class="headerlink" title="2️⃣ MAC 地址详解"></a>2️⃣ MAC 地址详解</h3><p><strong>MAC 地址（Media Access Control Address）</strong> - 网卡的物理地址</p>
<p><strong>特点：</strong></p>
<ul>
<li><strong>长度</strong>：48 位（6 字节），写成 12 个十六进制数</li>
<li><strong>格式</strong>：<code>C8-15-4E-A8-D3-FB</code> 或 <code>C8:15:4E:A8:D3:FB</code></li>
<li><strong>前 3 字节</strong>：OUI（厂商标识）</li>
<li><strong>后 3 字节</strong>：厂商分配的序列号</li>
</ul>
<p><strong>特殊 MAC 地址：</strong></p>
<ul>
<li><strong>广播地址</strong>：<code>FF-FF-FF-FF-FF-FF</code>（所有设备接收）</li>
<li><strong>多播地址</strong>：第一字节最低位为 1，如 <code>01-00-5e-xx-xx-xx</code></li>
</ul>
<h3 id="3️⃣-ARP-协议（Address-Resolution-Protocol）"><a href="#3️⃣-ARP-协议（Address-Resolution-Protocol）" class="headerlink" title="3️⃣ ARP 协议（Address Resolution Protocol）"></a>3️⃣ ARP 协议（Address Resolution Protocol）</h3><p><strong>ARP 的作用：将 IP 地址转换为 MAC 地址</strong></p>
<p><strong>为什么需要 ARP？</strong></p>
<ul>
<li>网络层使用 IP 地址（如 192.168.2.5）</li>
<li>数据链路层使用 MAC 地址（如 C8-15-4E-A8-D3-FB）</li>
<li>ARP 负责在两者之间建立映射</li>
</ul>
<p><strong>ARP 工作流程：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">主机 A (192.168.2.5) 想要发送数据给主机 B (192.168.2.10)</span><br><span class="line"></span><br><span class="line">步骤 1: A 检查 ARP 缓存</span><br><span class="line">  └─ 如果没有 192.168.2.10 的 MAC → 发送 ARP 请求</span><br><span class="line"></span><br><span class="line">步骤 2: A 发送 ARP 请求（广播）</span><br><span class="line">  ┌────────────────────────────────────┐</span><br><span class="line">  │ 谁有 192.168.2.10？               │</span><br><span class="line">  │ 请告诉 192.168.2.5                │</span><br><span class="line">  │ 我的 MAC 是 C8-15-4E-A8-D3-FB     │</span><br><span class="line">  │ 目标 MAC: FF-FF-FF-FF-FF-FF（广播）│</span><br><span class="line">  └────────────────────────────────────┘</span><br><span class="line">       ↓ 局域网所有设备都收到</span><br><span class="line"></span><br><span class="line">步骤 3: 主机 B 回复 ARP 应答（单播）</span><br><span class="line">  ┌────────────────────────────────────┐</span><br><span class="line">  │ 我是 192.168.2.10                 │</span><br><span class="line">  │ 我的 MAC 是 AA-BB-CC-DD-EE-FF     │</span><br><span class="line">  │ 目标 MAC: C8-15-4E-A8-D3-FB       │</span><br><span class="line">  └────────────────────────────────────┘</span><br><span class="line">       ↓ 单播回复给主机 A</span><br><span class="line"></span><br><span class="line">步骤 4: A 将映射存入 ARP 缓存</span><br><span class="line">  192.168.2.10 → AA-BB-CC-DD-EE-FF</span><br></pre></td></tr></table></figure>

<p><strong>ARP 报文结构：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">字段名称              说明                      值（请求/应答）</span><br><span class="line">────────────────────────────────────────────────────────────</span><br><span class="line">硬件类型              1 = 以太网                1</span><br><span class="line">协议类型              0x0800 = IPv4             0x0800</span><br><span class="line">硬件地址长度          MAC 地址长度              6</span><br><span class="line">协议地址长度          IP 地址长度               4</span><br><span class="line">操作码                1=请求, 2=应答            1 或 2</span><br><span class="line">发送者 MAC 地址       发送者的物理地址          实际 MAC</span><br><span class="line">发送者 IP 地址        发送者的 IP               实际 IP</span><br><span class="line">目标 MAC 地址         目标的物理地址            00-00-00-00-00-00 (请求)</span><br><span class="line">目标 IP 地址          目标的 IP                 查询的 IP</span><br></pre></td></tr></table></figure>

<h3 id="4️⃣-交换机工作原理"><a href="#4️⃣-交换机工作原理" class="headerlink" title="4️⃣ 交换机工作原理"></a>4️⃣ 交换机工作原理</h3><p><strong>交换机（Switch）</strong> 根据 MAC 地址转发数据帧。</p>
<p><strong>MAC 地址表（CAM 表）示例：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">端口    MAC 地址              学习时间</span><br><span class="line">────────────────────────────────────</span><br><span class="line">1       C8-15-4E-A8-D3-FB     10秒前</span><br><span class="line">2       AA-BB-CC-DD-EE-FF     5秒前</span><br><span class="line">3       11-22-33-44-55-66     2秒前</span><br></pre></td></tr></table></figure>

<p><strong>转发决策：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">收到数据帧时：</span><br><span class="line">1. 学习源 MAC → 记录来自哪个端口</span><br><span class="line">2. 查找目标 MAC：</span><br><span class="line">   ├─ 在表中找到 → 单播转发到对应端口</span><br><span class="line">   ├─ 广播地址 → 洪泛到所有端口</span><br><span class="line">   └─ 找不到 → 洪泛到所有端口（除接收端口）</span><br></pre></td></tr></table></figure>

<p><strong>广播域（Broadcast Domain）：</strong></p>
<ul>
<li>广播帧能到达的所有设备范围</li>
<li>同一交换机下的所有端口在同一广播域</li>
<li>路由器可以隔离广播域</li>
</ul>
<h3 id="5️⃣-ARP-安全问题（理论）"><a href="#5️⃣-ARP-安全问题（理论）" class="headerlink" title="5️⃣ ARP 安全问题（理论）"></a>5️⃣ ARP 安全问题（理论）</h3><p>⚠️ <strong>ARP 欺骗&#x2F;中间人攻击：</strong></p>
<ul>
<li>ARP 没有认证机制</li>
<li>攻击者可发送伪造的 ARP 应答</li>
<li>劫持或窃听流量</li>
</ul>
<p><strong>防护措施：</strong></p>
<ul>
<li>静态 ARP 条目（关键设备）</li>
<li>ARP 防护软件</li>
<li>交换机 DAI（Dynamic ARP Inspection）</li>
</ul>
<h2 id="实践任务（合法授权范围内）"><a href="#实践任务（合法授权范围内）" class="headerlink" title="实践任务（合法授权范围内）"></a>实践任务（合法授权范围内）</h2><h3 id="📦-任务准备：安装-Wireshark"><a href="#📦-任务准备：安装-Wireshark" class="headerlink" title="📦 任务准备：安装 Wireshark"></a>📦 任务准备：安装 Wireshark</h3><p><strong>方法 1：使用 Winget 安装</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">winget install <span class="literal">-e</span> <span class="literal">--id</span> WiresharkFoundation.Wireshark</span><br></pre></td></tr></table></figure>

<p><strong>方法 2：手动下载安装</strong></p>
<ul>
<li>访问：<a target="_blank" rel="noopener" href="https://www.wireshark.org/download.html">https://www.wireshark.org/download.html</a></li>
<li>下载：Windows Installer (64-bit)</li>
<li>安装时勾选：Npcap（网络抓包驱动）</li>
</ul>
<h3 id="🎯-任务-1-使用-Wireshark-抓取本地-ARP-流量"><a href="#🎯-任务-1-使用-Wireshark-抓取本地-ARP-流量" class="headerlink" title="🎯 任务 1: 使用 Wireshark 抓取本地 ARP 流量"></a>🎯 任务 1: 使用 Wireshark 抓取本地 ARP 流量</h3><p><strong>步骤 1：启动 Wireshark</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动 Wireshark（安装后）</span></span><br><span class="line">wireshark</span><br></pre></td></tr></table></figure>

<p><strong>步骤 2：选择网络接口</strong></p>
<ul>
<li>双击你的活动网络接口（如：Wi-Fi、以太网）</li>
<li>提示：有流量活动的接口会显示实时图表</li>
</ul>
<p><strong>步骤 3：设置显示过滤器</strong></p>
<ul>
<li>在顶部过滤栏输入：<code>arp</code></li>
<li>按 Enter 键应用过滤器</li>
<li>只显示 ARP 协议的数据包</li>
</ul>
<p><strong>步骤 4：生成 ARP 流量</strong></p>
<p>在 PowerShell 中执行以下命令（触发 ARP 请求）：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 清空 ARP 缓存（需要管理员权限）</span></span><br><span class="line"><span class="comment"># 如果没有管理员权限，可以跳过此步骤</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Ping 网关以触发 ARP</span></span><br><span class="line">ping <span class="literal">-n</span> <span class="number">2</span> <span class="number">192.168</span>.<span class="number">2.1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Ping 同网段其他 IP（可能不存在，但会触发 ARP）</span></span><br><span class="line">ping <span class="literal">-n</span> <span class="number">1</span> <span class="number">192.168</span>.<span class="number">2.100</span></span><br><span class="line">ping <span class="literal">-n</span> <span class="number">1</span> <span class="number">192.168</span>.<span class="number">2.101</span></span><br></pre></td></tr></table></figure>

<p><strong>步骤 5：分析 ARP 数据包</strong></p>
<p>在 Wireshark 中，你会看到两种类型的 ARP 包：</p>
<p><strong>ARP 请求包（Request）特征：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Info: Who has 192.168.2.1? Tell 192.168.2.5</span><br></pre></td></tr></table></figure>

<p><strong>ARP 应答包（Reply）特征：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Info: 192.168.2.1 is at 38:3d:5b:0c:92:1c</span><br></pre></td></tr></table></figure>

<p><strong>步骤 6：详细字段标注</strong></p>
<p>点击一个 ARP 请求包，在中间窗格展开字段：</p>
<h3 id="📊-ARP-请求包字段标注"><a href="#📊-ARP-请求包字段标注" class="headerlink" title="📊 ARP 请求包字段标注"></a>📊 ARP 请求包字段标注</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Frame（帧信息）</span><br><span class="line">├─ Ethernet II（以太网帧头）</span><br><span class="line">│  ├─ Destination: ff:ff:ff:ff:ff:ff（广播 MAC）</span><br><span class="line">│  ├─ Source: c8:15:4e:a8:d3:fb（本机 MAC）</span><br><span class="line">│  └─ Type: ARP (0x0806)（协议类型）</span><br><span class="line">│</span><br><span class="line">└─ Address Resolution Protocol (request)</span><br><span class="line">   ├─ Hardware type: Ethernet (1)（硬件类型：以太网）</span><br><span class="line">   ├─ Protocol type: IPv4 (0x0800)（协议类型：IPv4）</span><br><span class="line">   ├─ Hardware size: 6（MAC 地址长度）</span><br><span class="line">   ├─ Protocol size: 4（IP 地址长度）</span><br><span class="line">   ├─ Opcode: request (1)（操作码：请求）</span><br><span class="line">   ├─ Sender MAC address: c8:15:4e:a8:d3:fb（发送者 MAC）</span><br><span class="line">   ├─ Sender IP address: 192.168.2.5（发送者 IP）</span><br><span class="line">   ├─ Target MAC address: 00:00:00:00:00:00（目标 MAC，未知）</span><br><span class="line">   └─ Target IP address: 192.168.2.1（目标 IP，要查询的）</span><br></pre></td></tr></table></figure>

<h3 id="📊-ARP-应答包字段标注"><a href="#📊-ARP-应答包字段标注" class="headerlink" title="📊 ARP 应答包字段标注"></a>📊 ARP 应答包字段标注</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Frame（帧信息）</span><br><span class="line">├─ Ethernet II（以太网帧头）</span><br><span class="line">│  ├─ Destination: c8:15:4e:a8:d3:fb（请求者 MAC，单播）</span><br><span class="line">│  ├─ Source: 38:3d:5b:0c:92:1c（网关 MAC）</span><br><span class="line">│  └─ Type: ARP (0x0806)</span><br><span class="line">│</span><br><span class="line">└─ Address Resolution Protocol (reply)</span><br><span class="line">   ├─ Hardware type: Ethernet (1)</span><br><span class="line">   ├─ Protocol type: IPv4 (0x0800)</span><br><span class="line">   ├─ Hardware size: 6</span><br><span class="line">   ├─ Protocol size: 4</span><br><span class="line">   ├─ Opcode: reply (2)（操作码：应答）</span><br><span class="line">   ├─ Sender MAC address: 38:3d:5b:0c:92:1c（网关 MAC，已知）</span><br><span class="line">   ├─ Sender IP address: 192.168.2.1（网关 IP）</span><br><span class="line">   ├─ Target MAC address: c8:15:4e:a8:d3:fb（请求者 MAC）</span><br><span class="line">   └─ Target IP address: 192.168.2.5（请求者 IP）</span><br></pre></td></tr></table></figure>

<p><strong>关键区别对比：</strong></p>
<table>
<thead>
<tr>
<th>字段</th>
<th>ARP 请求</th>
<th>ARP 应答</th>
</tr>
</thead>
<tbody><tr>
<td><strong>以太网目标 MAC</strong></td>
<td>FF:FF:FF:FF:FF:FF（广播）</td>
<td>C8:15:4E:A8:D3:FB（单播）</td>
</tr>
<tr>
<td><strong>操作码</strong></td>
<td>1（request）</td>
<td>2（reply）</td>
</tr>
<tr>
<td><strong>目标 MAC</strong></td>
<td>00:00:00:00:00:00（未知）</td>
<td>C8:15:4E:A8:D3:FB（已知）</td>
</tr>
</tbody></table>
<p><strong>步骤 7：保存抓包文件</strong></p>
<ul>
<li>File → Save As</li>
<li>保存为：<code>day002_arp_capture.pcapng</code></li>
<li>可以随时重新打开分析</li>
</ul>
<h3 id="🎯-任务-2-观察-ARP-缓存（已完成）"><a href="#🎯-任务-2-观察-ARP-缓存（已完成）" class="headerlink" title="🎯 任务 2: 观察 ARP 缓存（已完成）"></a>🎯 任务 2: 观察 ARP 缓存（已完成）</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp <span class="literal">-a</span></span><br></pre></td></tr></table></figure>

<p>（此任务已在上面完成）</p>
<h2 id="巩固练习（题与复盘）"><a href="#巩固练习（题与复盘）" class="headerlink" title="巩固练习（题与复盘）"></a>巩固练习（题与复盘）</h2><ul>
<li>问答：为何需要 ARP？它解决了什么问题？</li>
<li>练习：识别抓包中 ARP 的请求&#x2F;应答并解释发送者&#x2F;目标字段</li>
</ul>
<h2 id="评估标准（达成判定）"><a href="#评估标准（达成判定）" class="headerlink" title="评估标准（达成判定）"></a>评估标准（达成判定）</h2><ul>
<li>能在抓包中准确定位与解释 ARP 报文</li>
<li>能说明 ARP 工作原理与安全注意事项（仅理论）</li>
</ul>
<h2 id="学习成果达成情况（由学习者填写）"><a href="#学习成果达成情况（由学习者填写）" class="headerlink" title="学习成果达成情况（由学习者填写）"></a>学习成果达成情况（由学习者填写）</h2><h3 id="📋-实践任务完成情况"><a href="#📋-实践任务完成情况" class="headerlink" title="📋 实践任务完成情况"></a>📋 实践任务完成情况</h3><p><strong>任务 1: 查看 ARP 缓存</strong></p>
<ul>
<li><p>关键命令与输出：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">arp <span class="literal">-a</span></span><br><span class="line"></span><br><span class="line">接口: <span class="number">192.168</span>.<span class="number">2.5</span> <span class="literal">---</span> <span class="number">0</span>x13</span><br><span class="line">  Internet 地址         物理地址              类型</span><br><span class="line">  <span class="number">192.168</span>.<span class="number">2.1</span>           <span class="number">38</span><span class="literal">-3d-5b-0c-92-1c</span>     动态</span><br><span class="line">  <span class="number">192.168</span>.<span class="number">2.255</span>         ff<span class="literal">-ff-ff-ff-ff-ff</span>     静态</span><br><span class="line">  <span class="number">224.0</span>.<span class="number">0.22</span>            <span class="number">01</span><span class="literal">-00-5e-00-00-16</span>     静态</span><br><span class="line">  <span class="number">224.0</span>.<span class="number">0.251</span>           <span class="number">01</span><span class="literal">-00-5e-00-00-fb</span>     静态</span><br><span class="line">  <span class="number">224.0</span>.<span class="number">0.252</span>           <span class="number">01</span><span class="literal">-00-5e-00-00-fc</span>     静态</span><br><span class="line">  <span class="number">239.255</span>.<span class="number">255.250</span>       <span class="number">01</span><span class="literal">-00-5e-7f-ff-fa</span>     静态</span><br><span class="line">  <span class="number">255.255</span>.<span class="number">255.255</span>       ff<span class="literal">-ff-ff-ff-ff-ff</span>     静态</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>ARP 缓存条目分析：</strong></p>
<table>
<thead>
<tr>
<th>IP 地址</th>
<th>MAC 地址</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>192.168.2.1</td>
<td>38-3d-5b-0c-92-1c</td>
<td>动态</td>
<td><strong>网关&#x2F;路由器</strong> - 访问互联网的必经之路</td>
</tr>
<tr>
<td>192.168.2.255</td>
<td>ff-ff-ff-ff-ff-ff</td>
<td>静态</td>
<td>子网广播地址</td>
</tr>
<tr>
<td>224.0.0.251</td>
<td>01-00-5e-00-00-fb</td>
<td>静态</td>
<td>mDNS 多播地址（本地服务发现）</td>
</tr>
<tr>
<td>239.255.255.250</td>
<td>01-00-5e-7f-ff-fa</td>
<td>静态</td>
<td>SSDP 多播地址（UPnP 设备发现）</td>
</tr>
<tr>
<td>255.255.255.255</td>
<td>ff-ff-ff-ff-ff-ff</td>
<td>静态</td>
<td>全网广播地址</td>
</tr>
</tbody></table>
<p><strong>关键发现：</strong></p>
<ul>
<li>✅ 动态条目只有网关（192.168.2.1），说明最近只与网关通信</li>
<li>✅ 多播地址以 <code>01-00-5e</code> 开头，这是 IPv4 多播 MAC 的标准格式</li>
<li>✅ 广播 MAC 地址是 <code>ff-ff-ff-ff-ff-ff</code></li>
</ul>
<hr>
<p><strong>任务 2: Wireshark 抓取 ARP 流量（已完成）</strong> ✅</p>
<p><strong>实践操作：</strong></p>
<ol>
<li>✅ 启动 Wireshark 并选择 WLAN 3 接口</li>
<li>✅ 设置显示过滤器：<code>arp</code></li>
<li>✅ 执行 <code>ping 192.168.2.1</code> 生成 ARP 流量</li>
<li>✅ 成功捕获 ARP 请求和应答包</li>
<li>✅ 分析了数据包的详细字段</li>
</ol>
<p><strong>📸 实践截图：</strong></p>
<p><strong>截图 1: ARP 请求包（广播）</strong><br><img data-src="/../images/Day002/day002_arp_request.png" alt="day002_arp_request"></p>
<ul>
<li>Frame 540：ARP 请求包</li>
<li>目标 MAC: ff:ff:ff:ff:ff:ff（广播）</li>
<li>操作码: request (1)</li>
<li>目标 MAC 地址字段为 00:00:00:00:00:00（未知）</li>
</ul>
<p><strong>截图 2: ARP 应答包（单播）</strong><br><img data-src="/../images/Day002/day002_arp_reply-17667221686171.png" alt="day002_arp_reply"></p>
<ul>
<li>Frame 1742：ARP 应答包</li>
<li>目标 MAC: c8:15:4e:a8:d3:fb（单播回复给请求者）</li>
<li>操作码: reply (2)</li>
<li>发送者 MAC: 38:3d:5b:0c:92:1c（网关 Fiberhom）</li>
</ul>
<p><strong>捕获到的 ARP 包分析：</strong></p>
<p><strong>📦 ARP 请求包 (Request) - Frame 540：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">以太网帧头：</span><br><span class="line">├─ 源 MAC: c8:15:4e:a8:d3:fb（本机 MAC）</span><br><span class="line">├─ 目标 MAC: ff:ff:ff:ff:ff:ff（广播地址）</span><br><span class="line">└─ 类型: ARP (0x0806)</span><br><span class="line"></span><br><span class="line">ARP 报文：</span><br><span class="line">├─ 硬件类型: Ethernet (1)</span><br><span class="line">├─ 协议类型: IPv4 (0x0800)</span><br><span class="line">├─ 硬件地址长度: 6 字节</span><br><span class="line">├─ 协议地址长度: 4 字节</span><br><span class="line">├─ 操作码: request (1) ← 这是请求</span><br><span class="line">├─ 发送者 MAC: c8:15:4e:a8:d3:fb</span><br><span class="line">├─ 发送者 IP: 192.168.2.5（我的 IP）</span><br><span class="line">├─ 目标 MAC: 00:00:00:00:00:00（未知，需要查询）</span><br><span class="line">└─ 目标 IP: 192.168.2.1（网关 IP）</span><br><span class="line"></span><br><span class="line">含义：&quot;我是 192.168.2.5，谁有 192.168.2.1？告诉我你的 MAC！&quot;</span><br></pre></td></tr></table></figure>

<p><strong>📦 ARP 应答包 (Reply) - Frame 1742：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">以太网帧头：</span><br><span class="line">├─ 源 MAC: 38:3d:5b:0c:92:1c（网关 MAC - Fiberhom）</span><br><span class="line">├─ 目标 MAC: c8:15:4e:a8:d3:fb（本机 MAC，单播）</span><br><span class="line">└─ 类型: ARP (0x0806)</span><br><span class="line"></span><br><span class="line">ARP 报文：</span><br><span class="line">├─ 硬件类型: Ethernet (1)</span><br><span class="line">├─ 协议类型: IPv4 (0x0800)</span><br><span class="line">├─ 硬件地址长度: 6 字节</span><br><span class="line">├─ 协议地址长度: 4 字节</span><br><span class="line">├─ 操作码: reply (2) ← 这是应答</span><br><span class="line">├─ 发送者 MAC: c8:15:4e:a8:d3:fb（我的 MAC）</span><br><span class="line">├─ 发送者 IP: 192.168.2.5（我的 IP）</span><br><span class="line">├─ 目标 MAC: 38:3d:5b:0c:92:1c（网关 MAC）</span><br><span class="line">└─ 目标 IP: 192.168.2.1（网关 IP）</span><br><span class="line"></span><br><span class="line">含义：&quot;我是 192.168.2.1，我的 MAC 是 38:3d:5b:0c:92:1c&quot;</span><br></pre></td></tr></table></figure>

<p><strong>🔍 关键观察与验证：</strong></p>
<table>
<thead>
<tr>
<th>对比项</th>
<th>ARP 请求</th>
<th>ARP 应答</th>
<th>验证结果</th>
</tr>
</thead>
<tbody><tr>
<td><strong>以太网目标 MAC</strong></td>
<td>ff:ff:ff:ff:ff:ff（广播）</td>
<td>c8:15:4e:a8:d3:fb（单播）</td>
<td>✅ 符合理论</td>
</tr>
<tr>
<td><strong>ARP 操作码</strong></td>
<td>1 (request)</td>
<td>2 (reply)</td>
<td>✅ 正确</td>
</tr>
<tr>
<td><strong>ARP 目标 MAC</strong></td>
<td>00:00:00:00:00:00（未知）</td>
<td>38:3d:5b:0c:92:1c（已知）</td>
<td>✅ 符合预期</td>
</tr>
<tr>
<td><strong>帧长度</strong></td>
<td>42 bytes</td>
<td>42 bytes</td>
<td>✅ ARP 包固定大小</td>
</tr>
<tr>
<td><strong>网关厂商</strong></td>
<td>-</td>
<td>Fiberhom</td>
<td>📝 光纤设备厂商</td>
</tr>
</tbody></table>
<p><strong>💡 实践收获：</strong></p>
<ol>
<li>✅ 亲眼看到了 ARP 请求使用广播 (ff:ff:ff:ff:ff:ff)</li>
<li>✅ 验证了 ARP 应答使用单播直接回复给请求者</li>
<li>✅ 理解了”谁有 IP？告诉 MAC”的实际过程</li>
<li>✅ 观察到了真实网络中的 MAC 地址和厂商信息</li>
<li>✅ 掌握了 Wireshark 的基本使用方法</li>
</ol>
<h3 id="📝-巩固练习答案"><a href="#📝-巩固练习答案" class="headerlink" title="📝 巩固练习答案"></a>📝 巩固练习答案</h3><p><strong>练习 1: 为何需要 ARP？它解决了什么问题？</strong></p>
<p><strong>答案：</strong><br>ARP 解决了<strong>网络层地址（IP）到数据链路层地址（MAC）的映射问题</strong>。</p>
<p><strong>原因：</strong></p>
<ol>
<li><strong>网络层使用 IP 地址</strong>：应用程序和路由使用 IP 地址（如 192.168.2.10）进行通信</li>
<li><strong>数据链路层使用 MAC 地址</strong>：以太网帧必须使用 MAC 地址（如 AA-BB-CC-DD-EE-FF）才能在局域网传输</li>
<li><strong>需要转换机制</strong>：当主机知道目标 IP 但不知道 MAC 时，无法发送以太网帧</li>
</ol>
<p><strong>ARP 的作用：</strong></p>
<ul>
<li>发送广播询问：”谁有这个 IP？请告诉我你的 MAC”</li>
<li>目标主机回复：”我有这个 IP，我的 MAC 是…”</li>
<li>建立 IP ↔ MAC 映射，缓存起来供后续使用</li>
</ul>
<p><strong>类比：</strong> IP 地址像家庭住址（用于导航），MAC 地址像门牌号（用于实际投递），ARP 就是查找门牌号的过程。</p>
<hr>
<p><strong>练习 2: 识别 ARP 请求&#x2F;应答并解释字段</strong></p>
<p><strong>ARP 请求报文示例：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">操作码: 1 (请求)</span><br><span class="line">发送者 MAC: C8-15-4E-A8-D3-FB  ← 我的 MAC（已知）</span><br><span class="line">发送者 IP:  192.168.2.5        ← 我的 IP（已知）</span><br><span class="line">目标 MAC:   00-00-00-00-00-00  ← 要查询的 MAC（未知，填0）</span><br><span class="line">目标 IP:    192.168.2.1        ← 要查询的 IP（已知）</span><br><span class="line"></span><br><span class="line">以太网帧头：</span><br><span class="line">源 MAC:     C8-15-4E-A8-D3-FB</span><br><span class="line">目标 MAC:   FF-FF-FF-FF-FF-FF  ← 广播，所有设备都收到</span><br></pre></td></tr></table></figure>

<p><strong>解释：</strong></p>
<ul>
<li>“我是 192.168.2.5 (MAC: C8-15-4E-A8-D3-FB)”</li>
<li>“谁有 192.168.2.1？请告诉我你的 MAC 地址”</li>
<li>使用广播发送，局域网内所有设备都能收到</li>
</ul>
<p><strong>ARP 应答报文示例：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">操作码: 2 (应答)</span><br><span class="line">发送者 MAC: 38-3d-5b-0c-92-1c  ← 网关的 MAC（被查询者）</span><br><span class="line">发送者 IP:  192.168.2.1        ← 网关的 IP（被查询者）</span><br><span class="line">目标 MAC:   C8-15-4E-A8-D3-FB  ← 请求者的 MAC</span><br><span class="line">目标 IP:    192.168.2.5        ← 请求者的 IP</span><br><span class="line"></span><br><span class="line">以太网帧头：</span><br><span class="line">源 MAC:     38-3d-5b-0c-92-1c</span><br><span class="line">目标 MAC:   C8-15-4E-A8-D3-FB  ← 单播回复，只发给请求者</span><br></pre></td></tr></table></figure>

<p><strong>解释：</strong></p>
<ul>
<li>“我是 192.168.2.1，我的 MAC 是 38-3d-5b-0c-92-1c”</li>
<li>“这是你要的信息，发送给 192.168.2.5”</li>
<li>使用单播回复，只有请求者收到</li>
</ul>
<h3 id="✅-结论与反思"><a href="#✅-结论与反思" class="headerlink" title="✅ 结论与反思"></a>✅ 结论与反思</h3><p><strong>核心知识点掌握：</strong></p>
<ol>
<li>✅ <strong>MAC 地址</strong>：48 位物理地址，全球唯一，用于局域网内数据传输</li>
<li>✅ <strong>ARP 协议</strong>：IP → MAC 的映射机制，使用”广播请求 + 单播应答”</li>
<li>✅ <strong>ARP 缓存</strong>：保存 IP-MAC 映射，动态条目有超时时间</li>
<li>✅ <strong>广播域</strong>：同一交换机下所有设备在同一广播域，ARP 请求会被所有设备接收</li>
<li>✅ <strong>交换机</strong>：根据 MAC 地址表转发，学习源 MAC，查找目标 MAC</li>
</ol>
<p><strong>实践理解：</strong></p>
<ul>
<li>本机 ARP 缓存中只有网关的动态条目，说明通常只需要与网关通信</li>
<li>访问互联网时：本机 → 网关（MAC 转发）→ 网关（IP 路由）→ 互联网</li>
<li>ARP 只在局域网内工作，跨网段通信通过路由器的 IP 路由实现</li>
</ul>
<p><strong>数据流转过程：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">访问百度 (220.181.38.148) 的过程：</span><br><span class="line">1. 检查目标 IP 220.181.38.148 不在本地网段（192.168.2.0/24）</span><br><span class="line">2. 查找路由表，确定需要发给默认网关 192.168.2.1</span><br><span class="line">3. 查 ARP 缓存，获取网关 MAC: 38-3d-5b-0c-92-1c</span><br><span class="line">4. 构造以太网帧：</span><br><span class="line">   - 目标 MAC: 38-3d-5b-0c-92-1c（网关）</span><br><span class="line">   - 源 MAC: C8-15-4E-A8-D3-FB（本机）</span><br><span class="line">   - IP 包内：目标 IP: 220.181.38.148（百度）</span><br><span class="line">5. 网关收到后，剥离以太网帧，根据 IP 路由转发</span><br></pre></td></tr></table></figure>

<p><strong>安全思考：</strong></p>
<ul>
<li>⚠️ ARP 无认证，易受欺骗攻击</li>
<li>🛡️ 关键设备应使用静态 ARP</li>
<li>🔍 异常 ARP 流量可能是攻击信号</li>
</ul>
<h2 id="1️⃣-⚠️-ARP-无认证，易受欺骗攻击"><a href="#1️⃣-⚠️-ARP-无认证，易受欺骗攻击" class="headerlink" title="1️⃣ ⚠️ ARP 无认证，易受欺骗攻击"></a>1️⃣ ⚠️ ARP 无认证，易受欺骗攻击</h2><h3 id="为什么-ARP-容易被欺骗？"><a href="#为什么-ARP-容易被欺骗？" class="headerlink" title="为什么 ARP 容易被欺骗？"></a>为什么 ARP 容易被欺骗？</h3><p><strong>ARP 协议的信任缺陷：</strong></p>
<ul>
<li>ARP 设计时<strong>没有身份验证机制</strong></li>
<li>主机会<strong>无条件信任</strong>收到的 ARP 应答</li>
<li>即使没有发送 ARP 请求，也会接受<strong>主动发来的 ARP 应答</strong>（Gratuitous ARP）</li>
<li>新的 ARP 应答会<strong>直接覆盖</strong>缓存中的旧条目</li>
</ul>
<h3 id="典型攻击场景：ARP-欺骗-x2F-中间人攻击"><a href="#典型攻击场景：ARP-欺骗-x2F-中间人攻击" class="headerlink" title="典型攻击场景：ARP 欺骗&#x2F;中间人攻击"></a>典型攻击场景：ARP 欺骗&#x2F;中间人攻击</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">正常通信：</span><br><span class="line">主机 A ←─────直接通信─────→ 网关</span><br><span class="line">(192.168.2.5)           (192.168.2.1)</span><br><span class="line"></span><br><span class="line">攻击后：</span><br><span class="line">主机 A ←───→ 攻击者 ←───→ 网关</span><br><span class="line">(192.168.2.5)  (192.168.2.100) (192.168.2.1)</span><br><span class="line">              ↑</span><br><span class="line">         冒充网关的 MAC</span><br><span class="line">         窃听/篡改流量</span><br></pre></td></tr></table></figure>

<p><strong>攻击步骤：</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 攻击者（192.168.2.100）的操作：</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 向主机 A 发送伪造的 ARP 应答</span></span><br><span class="line"><span class="comment"># &quot;我是网关 192.168.2.1，我的 MAC 是 攻击者的MAC&quot;</span></span><br><span class="line">伪造 ARP: <span class="number">192.168</span>.<span class="number">2.1</span> → 攻击者MAC（发给主机 A）</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 向网关发送伪造的 ARP 应答</span></span><br><span class="line"><span class="comment"># &quot;我是主机 192.168.2.5，我的 MAC 是 攻击者的MAC&quot;</span></span><br><span class="line">伪造 ARP: <span class="number">192.168</span>.<span class="number">2.5</span> → 攻击者MAC（发给网关）</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果：主机 A 和网关的流量都经过攻击者</span></span><br></pre></td></tr></table></figure>

<p><strong>危害：</strong></p>
<ul>
<li>🔓 窃听敏感信息（未加密的 HTTP、FTP、Telnet）</li>
<li>✂️ 篡改数据包内容</li>
<li>🚫 拒绝服务（不转发数据包）</li>
<li>🎣 劫持会话（Session Hijacking）</li>
</ul>
<hr>
<h2 id="2️⃣-🛡️-关键设备应使用静态-ARP"><a href="#2️⃣-🛡️-关键设备应使用静态-ARP" class="headerlink" title="2️⃣ 🛡️ 关键设备应使用静态 ARP"></a>2️⃣ 🛡️ 关键设备应使用静态 ARP</h2><h3 id="什么是静态-ARP？"><a href="#什么是静态-ARP？" class="headerlink" title="什么是静态 ARP？"></a>什么是静态 ARP？</h3><p><strong>静态 ARP 条目 &#x3D; 手动绑定 IP ↔ MAC，不会自动更新或超时</strong></p>
<h3 id="如何设置静态-ARP？"><a href="#如何设置静态-ARP？" class="headerlink" title="如何设置静态 ARP？"></a>如何设置静态 ARP？</h3><p><strong>在 Windows 上：</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前 ARP 缓存</span></span><br><span class="line">arp <span class="literal">-a</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加静态 ARP 条目（网关）</span></span><br><span class="line"><span class="comment"># 格式：arp -s &lt;IP地址&gt; &lt;MAC地址&gt;</span></span><br><span class="line">arp <span class="literal">-s</span> <span class="number">192.168</span>.<span class="number">2.1</span> <span class="number">38</span><span class="literal">-3d-5b-0c-92-1c</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证（类型应显示&quot;静态&quot;）</span></span><br><span class="line">arp <span class="literal">-a</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除静态条目</span></span><br><span class="line">arp <span class="literal">-d</span> <span class="number">192.168</span>.<span class="number">2.1</span></span><br></pre></td></tr></table></figure>

<p><strong>在 Linux 上：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加静态 ARP</span></span><br><span class="line">sudo arp -s 192.168.2.1 38:3d:5b:0c:92:1c</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或使用 ip 命令（推荐）</span></span><br><span class="line">sudo ip neigh add 192.168.2.1 lladdr 38:3d:5b:0c:92:1c dev eth0 nud permanent</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看</span></span><br><span class="line">ip neigh show</span><br></pre></td></tr></table></figure>

<h3 id="应该对哪些设备设置静态-ARP？"><a href="#应该对哪些设备设置静态-ARP？" class="headerlink" title="应该对哪些设备设置静态 ARP？"></a>应该对哪些设备设置静态 ARP？</h3><p><strong>高价值目标（推荐设置静态 ARP）：</strong></p>
<ul>
<li>✅ <strong>网关&#x2F;路由器</strong>（192.168.2.1）</li>
<li>✅ <strong>DNS 服务器</strong>（如果在局域网内）</li>
<li>✅ <strong>核心服务器</strong>（数据库、文件服务器、域控制器）</li>
<li>✅ <strong>安全设备</strong>（防火墙、IDS&#x2F;IPS）</li>
<li>✅ <strong>关键工作站</strong>（管理员电脑、财务电脑）</li>
</ul>
<h3 id="静态-ARP-的局限性"><a href="#静态-ARP-的局限性" class="headerlink" title="静态 ARP 的局限性"></a>静态 ARP 的局限性</h3><p><strong>缺点：</strong></p>
<ul>
<li>🔧 手动维护成本高（设备更换 MAC 需要手动更新）</li>
<li>📱 不适合 DHCP 环境（IP 会变化）</li>
<li>🌐 无法大规模部署（大型网络不现实）</li>
</ul>
<p><strong>更好的防护方案：</strong></p>
<ul>
<li>交换机启用 <strong>DAI（Dynamic ARP Inspection）</strong></li>
<li>部署 <strong>ARP 防护软件</strong>（如 ARPwatch）</li>
<li>使用 <strong>802.1X 网络接入认证</strong></li>
</ul>
<hr>
<h2 id="3️⃣-🔍-异常-ARP-流量可能是攻击信号"><a href="#3️⃣-🔍-异常-ARP-流量可能是攻击信号" class="headerlink" title="3️⃣ 🔍 异常 ARP 流量可能是攻击信号"></a>3️⃣ 🔍 异常 ARP 流量可能是攻击信号</h2><h3 id="如何检测异常-ARP-流量？"><a href="#如何检测异常-ARP-流量？" class="headerlink" title="如何检测异常 ARP 流量？"></a>如何检测异常 ARP 流量？</h3><h3 id="🚨-可疑信号-1：频繁的-ARP-请求-x2F-应答"><a href="#🚨-可疑信号-1：频繁的-ARP-请求-x2F-应答" class="headerlink" title="🚨 可疑信号 1：频繁的 ARP 请求&#x2F;应答"></a>🚨 可疑信号 1：频繁的 ARP 请求&#x2F;应答</h3><p><strong>正常情况：</strong></p>
<ul>
<li>ARP 请求偶尔出现（缓存过期时）</li>
<li>每个 IP 只有少量 ARP 流量</li>
</ul>
<p><strong>异常情况：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">连续的 ARP 应答（无对应请求）：</span><br><span class="line">192.168.2.1 is at aa:bb:cc:dd:ee:ff</span><br><span class="line">192.168.2.1 is at aa:bb:cc:dd:ee:ff</span><br><span class="line">192.168.2.1 is at aa:bb:cc:dd:ee:ff</span><br><span class="line">↑ 攻击者不断发送伪造应答，维持欺骗</span><br></pre></td></tr></table></figure>

<p><strong>在 Wireshark 中检测：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">显示过滤器：</span><br><span class="line">arp &amp;&amp; arp.opcode == 2 &amp;&amp; !arp.isgratuitous</span><br><span class="line"></span><br><span class="line">统计：</span><br><span class="line">Statistics → Conversations → Ethernet</span><br><span class="line">查看 ARP 流量占比，正常应 &lt; 1%</span><br></pre></td></tr></table></figure>

<h3 id="🚨-可疑信号-2：MAC-地址频繁变化"><a href="#🚨-可疑信号-2：MAC-地址频繁变化" class="headerlink" title="🚨 可疑信号 2：MAC 地址频繁变化"></a>🚨 可疑信号 2：MAC 地址频繁变化</h3><p><strong>正常情况：</strong></p>
<ul>
<li>一个 IP 对应的 MAC 地址稳定</li>
<li>除非设备重启或更换网卡</li>
</ul>
<p><strong>异常情况：</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第一次查询</span></span><br><span class="line">arp <span class="literal">-a</span></span><br><span class="line"><span class="number">192.168</span>.<span class="number">2.1</span>    <span class="number">38</span><span class="literal">-3d-5b-0c-92-1c</span>    动态</span><br><span class="line"></span><br><span class="line"><span class="comment"># 10秒后再查</span></span><br><span class="line">arp <span class="literal">-a</span></span><br><span class="line"><span class="number">192.168</span>.<span class="number">2.1</span>    aa<span class="literal">-bb-cc-dd-ee-ff</span>    动态  ← MAC 变了！</span><br></pre></td></tr></table></figure>

<p><strong>检测方法：</strong></p>
<ul>
<li>使用 <strong>ARPwatch</strong> 监控 IP-MAC 绑定变化</li>
<li>在 Wireshark 中过滤同一 IP 的多个 MAC：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp.src.proto_ipv4 == 192.168.2.1</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="🚨-可疑信号-3：Gratuitous-ARP（免费-ARP）滥用"><a href="#🚨-可疑信号-3：Gratuitous-ARP（免费-ARP）滥用" class="headerlink" title="🚨 可疑信号 3：Gratuitous ARP（免费 ARP）滥用"></a>🚨 可疑信号 3：Gratuitous ARP（免费 ARP）滥用</h3><p><strong>正常 Gratuitous ARP：</strong></p>
<ul>
<li>设备启动时通告自己的 IP-MAC</li>
<li>格式：发送者 IP &#x3D; 目标 IP</li>
</ul>
<p><strong>攻击滥用：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">攻击者发送：</span><br><span class="line">Sender IP: 192.168.2.1（网关 IP）</span><br><span class="line">Sender MAC: 攻击者的 MAC</span><br><span class="line">Target IP: 192.168.2.1</span><br><span class="line">Target MAC: ff:ff:ff:ff:ff:ff（广播）</span><br></pre></td></tr></table></figure>

<p><strong>Wireshark 检测：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">显示过滤器：</span><br><span class="line">arp.isgratuitous == 1</span><br><span class="line"></span><br><span class="line">观察：</span><br><span class="line">- 是否来自合法设备？</span><br><span class="line">- 频率是否异常？</span><br></pre></td></tr></table></figure>

<h3 id="🚨-可疑信号-4：ARP-扫描"><a href="#🚨-可疑信号-4：ARP-扫描" class="headerlink" title="🚨 可疑信号 4：ARP 扫描"></a>🚨 可疑信号 4：ARP 扫描</h3><p><strong>攻击者扫描网段：</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 攻击者对所有 IP 发送 ARP 请求</span></span><br><span class="line">Who has <span class="number">192.168</span>.<span class="number">2.1</span>? Tell <span class="number">192.168</span>.<span class="number">2.100</span></span><br><span class="line">Who has <span class="number">192.168</span>.<span class="number">2.2</span>? Tell <span class="number">192.168</span>.<span class="number">2.100</span></span><br><span class="line">Who has <span class="number">192.168</span>.<span class="number">2.3</span>? Tell <span class="number">192.168</span>.<span class="number">2.100</span></span><br><span class="line">...</span><br><span class="line">Who has <span class="number">192.168</span>.<span class="number">2.254</span>? Tell <span class="number">192.168</span>.<span class="number">2.100</span></span><br></pre></td></tr></table></figure>

<p><strong>特征：</strong></p>
<ul>
<li>来自同一源 MAC 的大量 ARP 请求</li>
<li>目标 IP 连续递增</li>
</ul>
<hr>
<h2 id="💡-综合防护建议"><a href="#💡-综合防护建议" class="headerlink" title="💡 综合防护建议"></a>💡 综合防护建议</h2><h3 id="个人-x2F-小型网络"><a href="#个人-x2F-小型网络" class="headerlink" title="个人&#x2F;小型网络"></a>个人&#x2F;小型网络</h3><ol>
<li>✅ 关键设备设置静态 ARP（网关、服务器）</li>
<li>✅ 定期检查 ARP 缓存是否异常</li>
<li>✅ 使用 HTTPS、SSH 等加密协议</li>
<li>✅ 安装 ARP 防火墙软件（如 ARPGuard）</li>
</ol>
<h3 id="企业网络"><a href="#企业网络" class="headerlink" title="企业网络"></a>企业网络</h3><ol>
<li>✅ 交换机启用 <strong>DAI（Dynamic ARP Inspection）</strong><ul>
<li>验证 ARP 包的合法性</li>
<li>与 DHCP Snooping 结合使用</li>
</ul>
</li>
<li>✅ 部署 <strong>ARPwatch</strong> 或 SIEM 监控</li>
<li>✅ 使用 <strong>802.1X</strong> 网络接入认证</li>
<li>✅ 网络分段（VLAN）隔离关键系统</li>
<li>✅ 启用交换机端口安全（Port Security）</li>
</ol>
<h3 id="Wireshark-检测命令速查"><a href="#Wireshark-检测命令速查" class="headerlink" title="Wireshark 检测命令速查"></a>Wireshark 检测命令速查</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># 只看 ARP 流量</span><br><span class="line">arp</span><br><span class="line"></span><br><span class="line"># 只看 ARP 应答</span><br><span class="line">arp.opcode == 2</span><br><span class="line"></span><br><span class="line"># 检测 Gratuitous ARP</span><br><span class="line">arp.isgratuitous == 1</span><br><span class="line"></span><br><span class="line"># 检测同一 IP 的多个 MAC（欺骗）</span><br><span class="line">arp.src.proto_ipv4 == 192.168.2.1</span><br><span class="line"></span><br><span class="line"># 检测 ARP 风暴（大量请求）</span><br><span class="line">arp.opcode == 1</span><br><span class="line"></span><br><span class="line"># 统计 ARP 流量占比</span><br><span class="line">Statistics → Protocol Hierarchy</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="🎯-实战验证（仅在授权靶场）"><a href="#🎯-实战验证（仅在授权靶场）" class="headerlink" title="🎯 实战验证（仅在授权靶场）"></a>🎯 实战验证（仅在授权靶场）</h2><p><strong>Day 后续会涉及的实验：</strong></p>
<ul>
<li>Week 5-6：使用 Ettercap&#x2F;arpspoof 演示 ARP 欺骗（仅靶场）</li>
<li>Week 7：配置交换机 DAI 防护</li>
<li>Week 10：在 SIEM 中配置 ARP 异常告警规则</li>
</ul>
<p><strong>安全边界：</strong></p>
<ul>
<li>⛔ 禁止在未授权网络进行 ARP 欺骗测试</li>
<li>⛔ 禁止对生产环境设备进行攻击性测试</li>
<li>✅ 仅在自建虚拟机网络或授权靶场实验</li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag"># 网络</a>
              <a href="/tags/%E5%AE%89%E5%85%A8/" rel="tag"># 安全</a>
              <a href="/tags/%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/" rel="tag"># 学习计划</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/post/d82a17eb.html" rel="prev" title="Day001：网络与协议基础 - 网络总览与模型">
                  <i class="fa fa-chevron-left"></i> Day001：网络与协议基础 - 网络总览与模型
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/post/eb37acc3.html" rel="next" title="Day003：网络与协议基础 - IP、ICMP 与路由基础">
                  Day003：网络与协议基础 - IP、ICMP 与路由基础 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="lv-container" data-id="city" data-uid="MTAyMC8zNDY4NC8xMTIyMQ=="></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2026</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Tigercoll</span>
</div>
<!-- 网站运行时间的设置 -->
<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("04/21/2019 15:54:40");//此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "等待与你相遇的 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
    }
setInterval("createtime()",250);
</script>
<!--
-->

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  




<script src="/js/third-party/comments/livere.js"></script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
