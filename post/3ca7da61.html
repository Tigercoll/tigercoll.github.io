<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css" integrity="sha256-jTIdiMuX/e3DGJUGwl3pKSxuc6YOuqtJYkM0bGQESA4=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"tigercoll.top","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.10.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>



<link rel="canonical" href="https://tigercoll.top/post/3ca7da61.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://tigercoll.top/post/3ca7da61.html","path":"post/3ca7da61.html","title":"Day015：操作系统与脚本 - Linux 安全基础"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Day015：操作系统与脚本 - Linux 安全基础 | Tigercoll's Blog</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Tigercoll's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>
	
      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Day015%EF%BC%9A%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B8%8E%E8%84%9A%E6%9C%AC-Linux-%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80"><span class="nav-number">1.</span> <span class="nav-text">Day015：操作系统与脚本 - Linux 安全基础</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%A6%E4%B9%A0%E7%9B%AE%E6%A0%87"><span class="nav-number">1.1.</span> <span class="nav-text">学习目标</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%A6%E4%B9%A0%E5%86%85%E5%AE%B9"><span class="nav-number">1.2.</span> <span class="nav-text">学习内容</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%EF%B8%8F%E2%83%A3-Linux-%E6%9D%83%E9%99%90%E6%A8%A1%E5%9E%8B%EF%BC%9A3-%E7%B1%BB%E4%BA%BA-%C3%97-3-%E7%A7%8D%E6%9D%83%E9%99%90-x3D-9-%E4%BD%8D%E6%9D%83%E9%99%90%E4%BD%8D"><span class="nav-number">1.2.1.</span> <span class="nav-text">1️⃣ Linux 权限模型：3 类人 × 3 种权限 &#x3D; 9 位权限位</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E6%9D%83%E9%99%90%EF%BC%88%E5%BF%85%E9%A1%BB%E6%8E%8C%E6%8F%A1%EF%BC%89"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">基础权限（必须掌握）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E8%AE%A1%E7%AE%97%EF%BC%88%E5%BF%AB%E9%80%9F%E8%AE%B0%E5%BF%86%EF%BC%89"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">权限计算（快速记忆）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E6%9D%83%E9%99%90%EF%BC%88%E8%BF%9B%E9%98%B6%E7%90%86%E8%A7%A3%EF%BC%89"><span class="nav-number">1.2.1.3.</span> <span class="nav-text">特殊权限（进阶理解）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2%EF%B8%8F%E2%83%A3-%E7%94%A8%E6%88%B7%E4%B8%8E%E7%BB%84%E7%AE%A1%E7%90%86%EF%BC%9A%E6%9C%80%E5%B0%8F%E6%9D%83%E9%99%90%E5%8E%9F%E5%88%99"><span class="nav-number">1.2.2.</span> <span class="nav-text">2️⃣ 用户与组管理：最小权限原则</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E5%8E%9F%E5%88%99"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">核心原则</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4"><span class="nav-number">1.2.2.2.</span> <span class="nav-text">用户管理命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sudo-%E9%85%8D%E7%BD%AE%EF%BC%88sudoers-%E6%96%87%E4%BB%B6%EF%BC%89"><span class="nav-number">1.2.2.3.</span> <span class="nav-text">sudo 配置（sudoers 文件）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3%EF%B8%8F%E2%83%A3-%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%EF%BC%9A%E6%94%BB%E5%87%BB%E9%9D%A2%E6%9C%80%E5%B0%8F%E5%8C%96"><span class="nav-number">1.2.3.</span> <span class="nav-text">3️⃣ 服务管理：攻击面最小化</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#systemd-%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%EF%BC%88%E7%8E%B0%E4%BB%A3-Linux%EF%BC%89"><span class="nav-number">1.2.3.1.</span> <span class="nav-text">systemd 服务管理（现代 Linux）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%91%E5%90%AC%E7%AB%AF%E5%8F%A3%E6%8E%92%E6%9F%A5%EF%BC%88%E6%94%BB%E5%87%BB%E9%9D%A2%E7%9B%98%E7%82%B9%EF%BC%89"><span class="nav-number">1.2.3.2.</span> <span class="nav-text">监听端口排查（攻击面盘点）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4%EF%B8%8F%E2%83%A3-%E6%97%A5%E5%BF%97%E5%AE%A1%E8%AE%A1%EF%BC%9A%E4%BD%A0%E7%9A%84%E2%80%9D%E9%BB%91%E5%8C%A3%E5%AD%90%E2%80%9D"><span class="nav-number">1.2.4.</span> <span class="nav-text">4️⃣ 日志审计：你的”黑匣子”</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E6%97%A5%E5%BF%97%E4%BD%8D%E7%BD%AE"><span class="nav-number">1.2.4.1.</span> <span class="nav-text">常见日志位置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E4%BA%8B%E4%BB%B6%E8%AF%86%E5%88%AB"><span class="nav-number">1.2.4.2.</span> <span class="nav-text">关键事件识别</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#journalctl-%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95"><span class="nav-number">1.2.4.3.</span> <span class="nav-text">journalctl 高级用法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5%EF%B8%8F%E2%83%A3-%E9%98%B2%E7%81%AB%E5%A2%99%E5%9F%BA%E7%A1%80%EF%BC%9Aiptables-vs-firewalld-vs-ufw"><span class="nav-number">1.2.5.</span> <span class="nav-text">5️⃣ 防火墙基础：iptables vs firewalld vs ufw</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ufw-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%EF%BC%88Ubuntu-%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="nav-number">1.2.5.1.</span> <span class="nav-text">ufw 快速入门（Ubuntu 推荐）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E8%B7%B5%E4%BB%BB%E5%8A%A1%EF%BC%88%E5%90%88%E6%B3%95%E6%8E%88%E6%9D%83%E8%8C%83%E5%9B%B4%E5%86%85%EF%BC%89"><span class="nav-number">1.3.</span> <span class="nav-text">实践任务（合法授权范围内）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%BB%E5%8A%A1-0%EF%BC%88%E5%87%86%E5%A4%87%E7%8E%AF%E5%A2%83%EF%BC%8C%E4%B8%89%E9%80%89%E4%B8%80%EF%BC%89"><span class="nav-number">1.3.1.</span> <span class="nav-text">任务 0（准备环境，三选一）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%BB%E5%8A%A1-1%EF%BC%88%E5%BF%85%E5%81%9A%EF%BC%89%EF%BC%9A%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E8%AF%86%E5%88%AB%E4%B8%8E%E8%BD%AC%E6%8D%A2"><span class="nav-number">1.3.2.</span> <span class="nav-text">任务 1（必做）：文件权限识别与转换</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-1%EF%BC%9A%E6%9F%A5%E7%9C%8B%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90"><span class="nav-number">1.3.2.1.</span> <span class="nav-text">步骤 1：查看敏感文件权限</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-2%EF%BC%9A%E6%9D%83%E9%99%90%E8%AE%A1%E7%AE%97%E7%BB%83%E4%B9%A0"><span class="nav-number">1.3.2.2.</span> <span class="nav-text">步骤 2：权限计算练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%BB%E5%8A%A1-2%EF%BC%88%E5%BF%85%E5%81%9A%EF%BC%89%EF%BC%9A%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7%E5%B9%B6%E9%85%8D%E7%BD%AE-sudo"><span class="nav-number">1.3.3.</span> <span class="nav-text">任务 2（必做）：创建用户并配置 sudo</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-1%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%96%B0%E7%94%A8%E6%88%B7"><span class="nav-number">1.3.3.1.</span> <span class="nav-text">步骤 1：创建新用户</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-2%EF%BC%9A%E5%B0%86%E7%94%A8%E6%88%B7%E5%8A%A0%E5%85%A5-sudo-%E7%BB%84"><span class="nav-number">1.3.3.2.</span> <span class="nav-text">步骤 2：将用户加入 sudo 组</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4-3%EF%BC%9A%E9%AA%8C%E8%AF%81%E9%85%8D%E7%BD%AE"><span class="nav-number">1.3.3.3.</span> <span class="nav-text">步骤 3：验证配置</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%BB%E5%8A%A1-3%EF%BC%88%E5%BF%85%E5%81%9A%EF%BC%89%EF%BC%9A%E7%9B%98%E7%82%B9%E7%9B%91%E5%90%AC%E7%AB%AF%E5%8F%A3%EF%BC%88%E6%94%BB%E5%87%BB%E9%9D%A2%E8%AF%84%E4%BC%B0%EF%BC%89"><span class="nav-number">1.3.4.</span> <span class="nav-text">任务 3（必做）：盘点监听端口（攻击面评估）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%BB%E5%8A%A1-4%EF%BC%88%E5%BF%85%E5%81%9A%EF%BC%89%EF%BC%9A%E6%9F%A5%E7%9C%8B%E8%AE%A4%E8%AF%81%E6%97%A5%E5%BF%97"><span class="nav-number">1.3.5.</span> <span class="nav-text">任务 4（必做）：查看认证日志</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%A1%88-A%EF%BC%9Ajournalctl%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="nav-number">1.3.5.1.</span> <span class="nav-text">方案 A：journalctl（推荐）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%A1%88-B%EF%BC%9A%E4%BC%A0%E7%BB%9F%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6"><span class="nav-number">1.3.5.2.</span> <span class="nav-text">方案 B：传统日志文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%BB%E5%8A%A1-5%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89%EF%BC%9A%E9%85%8D%E7%BD%AE-ufw-%E9%98%B2%E7%81%AB%E5%A2%99"><span class="nav-number">1.3.6.</span> <span class="nav-text">任务 5（可选）：配置 ufw 防火墙</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B7%A9%E5%9B%BA%E7%BB%83%E4%B9%A0%EF%BC%88%E9%A2%98%E4%B8%8E%E5%A4%8D%E7%9B%98%EF%BC%89"><span class="nav-number">1.4.</span> <span class="nav-text">巩固练习（题与复盘）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98-1%EF%BC%9A%E6%9D%83%E9%99%90%E8%BD%AC%E6%8D%A2%EF%BC%88%E5%BF%85%E5%81%9A%EF%BC%89"><span class="nav-number">1.4.1.</span> <span class="nav-text">题 1：权限转换（必做）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98-2%EF%BC%9A%E5%AE%89%E5%85%A8%E5%9C%BA%E6%99%AF%E5%88%A4%E6%96%AD%EF%BC%88%E5%BF%85%E5%81%9A%EF%BC%89"><span class="nav-number">1.4.2.</span> <span class="nav-text">题 2：安全场景判断（必做）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98-3%EF%BC%9A%E5%86%99%E4%B8%80%E4%BB%BD-Linux-%E5%8A%A0%E5%9B%BA%E6%B8%85%E5%8D%95%EF%BC%8810-%E6%9D%A1%E4%BB%A5%E4%B8%8A%EF%BC%89"><span class="nav-number">1.4.3.</span> <span class="nav-text">题 3：写一份 Linux 加固清单（10 条以上）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98-4%EF%BC%88%E8%BF%9B%E9%98%B6%EF%BC%89%EF%BC%9A%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA-sudo-%E6%9D%83%E9%99%90%E6%96%B9%E6%A1%88"><span class="nav-number">1.4.4.</span> <span class="nav-text">题 4（进阶）：设计一个 sudo 权限方案</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%84%E4%BC%B0%E6%A0%87%E5%87%86%EF%BC%88%E8%BE%BE%E6%88%90%E5%88%A4%E5%AE%9A%EF%BC%89"><span class="nav-number">1.5.</span> <span class="nav-text">评估标准（达成判定）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%A6%E4%B9%A0%E6%88%90%E6%9E%9C%E8%BE%BE%E6%88%90%E6%83%85%E5%86%B5%EF%BC%88%E7%94%B1%E5%AD%A6%E4%B9%A0%E8%80%85%E5%A1%AB%E5%86%99%EF%BC%89"><span class="nav-number">1.6.</span> <span class="nav-text">学习成果达成情况（由学习者填写）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%88%AA%E5%9B%BE%E4%B8%8E%E8%AF%81%E6%8D%AE"><span class="nav-number">1.6.1.</span> <span class="nav-text">截图与证据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E5%91%BD%E4%BB%A4%E4%B8%8E%E8%BE%93%E5%87%BA"><span class="nav-number">1.6.2.</span> <span class="nav-text">关键命令与输出</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E8%BD%AC%E6%8D%A2%E7%BB%83%E4%B9%A0%EF%BC%88%E9%A2%98-1-%E7%AD%94%E6%A1%88%EF%BC%89"><span class="nav-number">1.6.3.</span> <span class="nav-text">权限转换练习（题 1 答案）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E5%9C%BA%E6%99%AF%E5%88%A4%E6%96%AD%EF%BC%88%E9%A2%98-2-%E7%AD%94%E6%A1%88%EF%BC%89"><span class="nav-number">1.6.4.</span> <span class="nav-text">安全场景判断（题 2 答案）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Linux-%E5%8A%A0%E5%9B%BA%E6%B8%85%E5%8D%95%EF%BC%88%E9%A2%98-3-%E7%AD%94%E6%A1%88%EF%BC%89"><span class="nav-number">1.6.5.</span> <span class="nav-text">Linux 加固清单（题 3 答案）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B4%A6%E5%8F%B7%E7%AE%A1%E7%90%86%EF%BC%885-%E6%9D%A1%EF%BC%89"><span class="nav-number">1.6.5.1.</span> <span class="nav-text">账号管理（5 条）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6%EF%BC%883-%E6%9D%A1%EF%BC%89"><span class="nav-number">1.6.5.2.</span> <span class="nav-text">权限控制（3 条）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%EF%BC%883-%E6%9D%A1%EF%BC%89"><span class="nav-number">1.6.5.3.</span> <span class="nav-text">服务管理（3 条）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%EF%BC%884-%E6%9D%A1%EF%BC%89"><span class="nav-number">1.6.5.4.</span> <span class="nav-text">网络安全（4 条）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E5%AE%A1%E8%AE%A1%EF%BC%883-%E6%9D%A1%EF%BC%89"><span class="nav-number">1.6.5.5.</span> <span class="nav-text">日志审计（3 条）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sudo-%E6%9D%83%E9%99%90%E6%96%B9%E6%A1%88%EF%BC%88%E9%A2%98-4-%E7%AD%94%E6%A1%88%EF%BC%89"><span class="nav-number">1.6.6.</span> <span class="nav-text">sudo 权限方案（题 4 答案）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%93%E8%AE%BA%E4%B8%8E%E5%8F%8D%E6%80%9D"><span class="nav-number">1.6.7.</span> <span class="nav-text">结论与反思</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9B%86%E4%B8%AD%E5%8F%82%E8%80%83%E7%AD%94%E6%A1%88%EF%BC%88%E5%90%AB%E6%80%9D%E8%B7%AF%EF%BC%89"><span class="nav-number">1.7.</span> <span class="nav-text">集中参考答案（含思路）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98-1-%E5%8F%82%E8%80%83%E7%AD%94%E6%A1%88%EF%BC%88%E6%9D%83%E9%99%90%E8%BD%AC%E6%8D%A2%EF%BC%89"><span class="nav-number">1.7.1.</span> <span class="nav-text">题 1 参考答案（权限转换）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98-2-%E5%8F%82%E8%80%83%E7%AD%94%E6%A1%88%EF%BC%88%E8%AF%A6%E8%A7%81%E4%B8%8A%E6%96%B9%E2%80%9D%E5%AE%89%E5%85%A8%E5%9C%BA%E6%99%AF%E5%88%A4%E6%96%AD%E2%80%9D%EF%BC%89"><span class="nav-number">1.7.2.</span> <span class="nav-text">题 2 参考答案（详见上方”安全场景判断”）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98-3-%E5%8F%82%E8%80%83%E7%AD%94%E6%A1%88%EF%BC%88%E8%AF%A6%E8%A7%81%E4%B8%8A%E6%96%B9%E2%80%9DLinux-%E5%8A%A0%E5%9B%BA%E6%B8%85%E5%8D%95%E2%80%9D%EF%BC%8C%E5%85%B1-18-%E6%9D%A1%EF%BC%89"><span class="nav-number">1.7.3.</span> <span class="nav-text">题 3 参考答案（详见上方”Linux 加固清单”，共 18 条）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98-4-%E5%8F%82%E8%80%83%E7%AD%94%E6%A1%88%EF%BC%88%E8%AF%A6%E8%A7%81%E4%B8%8A%E6%96%B9%E2%80%9Dsudo-%E6%9D%83%E9%99%90%E6%96%B9%E6%A1%88%E2%80%9D%EF%BC%89"><span class="nav-number">1.7.4.</span> <span class="nav-text">题 4 参考答案（详见上方”sudo 权限方案”）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%A6%E4%B9%A0%E6%88%90%E6%9E%9C%E7%A4%BA%E4%BE%8B%E5%A1%AB%E5%86%99%EF%BC%88%E5%8F%AF%E7%85%A7%E6%8A%84%EF%BC%89"><span class="nav-number">1.8.</span> <span class="nav-text">学习成果示例填写（可照抄）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%88%AA%E5%9B%BE%E4%B8%8E%E8%AF%81%E6%8D%AE%EF%BC%88%E7%A4%BA%E4%BE%8B%EF%BC%89"><span class="nav-number">1.8.1.</span> <span class="nav-text">截图与证据（示例）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E5%91%BD%E4%BB%A4%E4%B8%8E%E8%BE%93%E5%87%BA%EF%BC%88%E7%A4%BA%E4%BE%8B%EF%BC%89"><span class="nav-number">1.8.2.</span> <span class="nav-text">关键命令与输出（示例）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8D%E6%80%9D%EF%BC%88%E7%A4%BA%E4%BE%8B%EF%BC%89"><span class="nav-number">1.8.3.</span> <span class="nav-text">反思（示例）</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Tigercoll"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Tigercoll</p>
  <div class="site-description" itemprop="description">万丈高楼平地起,勿在浮沙筑高台</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives">
          <span class="site-state-item-count">82</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories">
        <span class="site-state-item-count">40</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags">
        <span class="site-state-item-count">75</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Tigercoll" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Tigercoll" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tigercoll.top/post/3ca7da61.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Tigercoll">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tigercoll's Blog">
      <meta itemprop="description" content="万丈高楼平地起,勿在浮沙筑高台">
    </span>
    
    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Day015：操作系统与脚本 - Linux 安全基础 | Tigercoll's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Day015：操作系统与脚本 - Linux 安全基础
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2026-01-08 00:00:00" itemprop="dateCreated datePublished" datetime="2026-01-08T00:00:00+08:00">2026-01-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">网络安全</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="Day015：操作系统与脚本-Linux-安全基础"><a href="#Day015：操作系统与脚本-Linux-安全基础" class="headerlink" title="Day015：操作系统与脚本 - Linux 安全基础"></a>Day015：操作系统与脚本 - Linux 安全基础</h1><ul>
<li>日期：2026-01-08</li>
<li>周次：第 3 周</li>
</ul>
<h2 id="学习目标"><a href="#学习目标" class="headerlink" title="学习目标"></a>学习目标</h2><p>学完今天你应该能做到：</p>
<ul>
<li>能用一句话解释 Linux 安全三件套：<strong>用户&#x2F;组</strong>、<strong>权限</strong>、<strong>服务</strong></li>
<li>看懂 <code>-rwxr-xr-x</code> 权限字符串，能算出 <code>755/644</code>，理解特殊权限（SUID&#x2F;SGID&#x2F;Sticky Bit）</li>
<li>在”自建或明确授权”的 Linux 环境里完成最小加固动作：<ul>
<li>新建普通用户并配置 sudo</li>
<li>理解”禁止 root 直接登录”的原理（谨慎实施）</li>
<li>查看安全日志并识别关键事件（登录成功&#x2F;失败&#x2F;sudo 使用）</li>
<li>盘点监听端口（攻击面最小化）</li>
</ul>
</li>
<li>输出一份 Linux 加固清单（至少 10 条可执行措施）</li>
</ul>
<blockquote>
<p><strong>环境说明</strong>：没有 Linux 也能学！可用 WSL&#x2F;虚拟机&#x2F;云主机，或者先把”概念&#x2F;命令&#x2F;清单”整理出来。</p>
</blockquote>
<span id="more"></span>

<h2 id="学习内容"><a href="#学习内容" class="headerlink" title="学习内容"></a>学习内容</h2><h3 id="1️⃣-Linux-权限模型：3-类人-×-3-种权限-x3D-9-位权限位"><a href="#1️⃣-Linux-权限模型：3-类人-×-3-种权限-x3D-9-位权限位" class="headerlink" title="1️⃣ Linux 权限模型：3 类人 × 3 种权限 &#x3D; 9 位权限位"></a>1️⃣ Linux 权限模型：3 类人 × 3 种权限 &#x3D; 9 位权限位</h3><h4 id="基础权限（必须掌握）"><a href="#基础权限（必须掌握）" class="headerlink" title="基础权限（必须掌握）"></a>基础权限（必须掌握）</h4><p>Linux 文件权限看 <strong>3 类人</strong>：</p>
<table>
<thead>
<tr>
<th>类别</th>
<th>符号</th>
<th>含义</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Owner</strong></td>
<td><code>u</code></td>
<td>文件拥有者（创建者或被 chown 指定）</td>
<td>root、alice、www-data</td>
</tr>
<tr>
<td><strong>Group</strong></td>
<td><code>g</code></td>
<td>文件所属组（同组用户共享权限）</td>
<td>wheel、developers、www-data</td>
</tr>
<tr>
<td><strong>Others</strong></td>
<td><code>o</code></td>
<td>其他所有人（非 owner 非 group）</td>
<td>系统上的其他用户</td>
</tr>
</tbody></table>
<p>每类人有 <strong>3 个权限位</strong>：</p>
<table>
<thead>
<tr>
<th>权限</th>
<th>符号</th>
<th>数值</th>
<th>文件含义</th>
<th>目录含义</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Read</strong></td>
<td><code>r</code></td>
<td>4</td>
<td>可读取文件内容</td>
<td>可列出目录内容（ls）</td>
</tr>
<tr>
<td><strong>Write</strong></td>
<td><code>w</code></td>
<td>2</td>
<td>可修改文件内容</td>
<td>可在目录中创建&#x2F;删除文件</td>
</tr>
<tr>
<td><strong>Execute</strong></td>
<td><code>x</code></td>
<td>1</td>
<td>可执行文件（脚本&#x2F;二进制）</td>
<td>可进入目录（cd）</td>
</tr>
</tbody></table>
<h4 id="权限计算（快速记忆）"><a href="#权限计算（快速记忆）" class="headerlink" title="权限计算（快速记忆）"></a>权限计算（快速记忆）</h4><table>
<thead>
<tr>
<th>数字</th>
<th>二进制</th>
<th>权限</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><strong>7</strong></td>
<td>111</td>
<td><code>rwx</code></td>
<td>读+写+执行 (4+2+1)</td>
</tr>
<tr>
<td><strong>6</strong></td>
<td>110</td>
<td><code>rw-</code></td>
<td>读+写 (4+2)</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>101</td>
<td><code>r-x</code></td>
<td>读+执行 (4+1)</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>100</td>
<td><code>r--</code></td>
<td>只读 (4)</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>011</td>
<td><code>-wx</code></td>
<td>写+执行 (2+1)</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>010</td>
<td><code>-w-</code></td>
<td>只写 (2)</td>
</tr>
<tr>
<td><strong>1</strong></td>
<td>001</td>
<td><code>--x</code></td>
<td>只执行 (1)</td>
</tr>
<tr>
<td><strong>0</strong></td>
<td>000</td>
<td><code>---</code></td>
<td>无权限 (0)</td>
</tr>
</tbody></table>
<p><strong>常见权限组合</strong>：</p>
<table>
<thead>
<tr>
<th>权限</th>
<th>数字表示</th>
<th>典型用途</th>
<th>示例文件</th>
</tr>
</thead>
<tbody><tr>
<td><code>-rw-r--r--</code></td>
<td><strong>644</strong></td>
<td>普通文件（owner 可写，其他人只读）</td>
<td><code>/etc/passwd</code></td>
</tr>
<tr>
<td><code>-rwxr-xr-x</code></td>
<td><strong>755</strong></td>
<td>可执行文件&#x2F;脚本</td>
<td><code>/usr/bin/ls</code></td>
</tr>
<tr>
<td><code>-rw-------</code></td>
<td><strong>600</strong></td>
<td>私密文件（只有 owner 可读写）</td>
<td><code>~/.ssh/id_rsa</code></td>
</tr>
<tr>
<td><code>-rw-r-----</code></td>
<td><strong>640</strong></td>
<td>敏感配置（owner 可写，group 可读）</td>
<td><code>/etc/shadow</code></td>
</tr>
<tr>
<td><code>drwxr-xr-x</code></td>
<td><strong>755</strong></td>
<td>普通目录</td>
<td><code>/home/alice</code></td>
</tr>
<tr>
<td><code>drwx------</code></td>
<td><strong>700</strong></td>
<td>私密目录</td>
<td><code>~/.ssh/</code></td>
</tr>
</tbody></table>
<p><strong>实战示例</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看文件权限</span></span><br><span class="line"><span class="built_in">ls</span> -l /etc/passwd</span><br><span class="line"><span class="comment"># 输出：-rw-r--r-- 1 root root 2847 Jan 1 12:00 /etc/passwd</span></span><br><span class="line"><span class="comment">#      │└┬┘└┬┘└┬┘  │  │    │    │    │</span></span><br><span class="line"><span class="comment">#      │ │  │  │   │  │    │    │    └─ 文件名</span></span><br><span class="line"><span class="comment">#      │ │  │  │   │  │    │    └─ 修改时间</span></span><br><span class="line"><span class="comment">#      │ │  │  │   │  │    └─ 文件大小</span></span><br><span class="line"><span class="comment">#      │ │  │  │   │  └─ 所属组</span></span><br><span class="line"><span class="comment">#      │ │  │  │   └─ 所有者</span></span><br><span class="line"><span class="comment">#      │ │  │  └─ others (r--) = 4</span></span><br><span class="line"><span class="comment">#      │ │  └─ group (r--) = 4</span></span><br><span class="line"><span class="comment">#      │ └─ owner (rw-) = 6</span></span><br><span class="line"><span class="comment">#      └─ 文件类型 (- 普通文件, d 目录, l 软链接)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">ls</span> -l /etc/shadow</span><br><span class="line"><span class="comment"># 输出：-rw-r----- 1 root shadow 1234 Jan 1 12:00 /etc/shadow</span></span><br><span class="line"><span class="comment"># 权限：640 (owner=rw, group=r, others=无)</span></span><br><span class="line"><span class="comment"># 原因：密码哈希敏感，只有 root 和 shadow 组可读</span></span><br></pre></td></tr></table></figure>

<h4 id="特殊权限（进阶理解）"><a href="#特殊权限（进阶理解）" class="headerlink" title="特殊权限（进阶理解）"></a>特殊权限（进阶理解）</h4><table>
<thead>
<tr>
<th>权限</th>
<th>符号</th>
<th>数值</th>
<th>作用</th>
<th>典型应用</th>
</tr>
</thead>
<tbody><tr>
<td><strong>SUID</strong></td>
<td><code>s</code>（owner x 位）</td>
<td>4000</td>
<td>执行时以文件 owner 身份运行</td>
<td><code>/usr/bin/passwd</code>（普通用户改密码需要写 &#x2F;etc&#x2F;shadow）</td>
</tr>
<tr>
<td><strong>SGID</strong></td>
<td><code>s</code>（group x 位）</td>
<td>2000</td>
<td>执行时以文件 group 身份运行；目录中新建文件继承目录 group</td>
<td>共享目录</td>
</tr>
<tr>
<td><strong>Sticky Bit</strong></td>
<td><code>t</code>（others x 位）</td>
<td>1000</td>
<td>目录中只有文件 owner 才能删除自己的文件</td>
<td><code>/tmp</code>（防止用户互删文件）</td>
</tr>
</tbody></table>
<p><strong>SUID 示例</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -l /usr/bin/passwd</span><br><span class="line"><span class="comment"># 输出：-rwsr-xr-x 1 root root 68208 /usr/bin/passwd</span></span><br><span class="line"><span class="comment">#           ↑ s 表示 SUID（4755）</span></span><br><span class="line"><span class="comment"># 原理：普通用户执行 passwd 时，临时获得 root 权限，可以修改 /etc/shadow</span></span><br></pre></td></tr></table></figure>

<p><strong>危险点</strong>：</p>
<ul>
<li>❌ <strong>SUID 滥用</strong>：攻击者可能利用有漏洞的 SUID 程序提权</li>
<li>✅ <strong>定期检查</strong>：<code>find / -perm -4000 -type f 2&gt;/dev/null</code>（查找所有 SUID 文件）</li>
</ul>
<h3 id="2️⃣-用户与组管理：最小权限原则"><a href="#2️⃣-用户与组管理：最小权限原则" class="headerlink" title="2️⃣ 用户与组管理：最小权限原则"></a>2️⃣ 用户与组管理：最小权限原则</h3><h4 id="核心原则"><a href="#核心原则" class="headerlink" title="核心原则"></a>核心原则</h4><ul>
<li><strong>日常用普通用户</strong>：避免全程 root 操作（误操作 &#x3D; 灾难）</li>
<li><strong>sudo 按需提权</strong>：需要时才提升权限，操作可审计</li>
<li><strong>禁止 root 远程登录</strong>：防止暴力破解（改用密钥认证 + 普通用户登录）</li>
</ul>
<h4 id="用户管理命令"><a href="#用户管理命令" class="headerlink" title="用户管理命令"></a>用户管理命令</h4><table>
<thead>
<tr>
<th>操作</th>
<th>命令</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>新建用户</td>
<td><code>useradd -m &lt;用户名&gt;</code></td>
<td><code>sudo useradd -m alice</code></td>
</tr>
<tr>
<td>设置密码</td>
<td><code>passwd &lt;用户名&gt;</code></td>
<td><code>sudo passwd alice</code></td>
</tr>
<tr>
<td>删除用户</td>
<td><code>userdel -r &lt;用户名&gt;</code></td>
<td><code>sudo userdel -r alice</code>（<code>-r</code> 删除主目录）</td>
</tr>
<tr>
<td>修改用户组</td>
<td><code>usermod -aG &lt;组名&gt; &lt;用户&gt;</code></td>
<td><code>sudo usermod -aG sudo alice</code></td>
</tr>
<tr>
<td>查看用户信息</td>
<td><code>id &lt;用户名&gt;</code></td>
<td><code>id alice</code></td>
</tr>
<tr>
<td>列出所有用户</td>
<td><code>cat /etc/passwd</code></td>
<td>查看 UID、主目录、默认 shell</td>
</tr>
</tbody></table>
<h4 id="sudo-配置（sudoers-文件）"><a href="#sudo-配置（sudoers-文件）" class="headerlink" title="sudo 配置（sudoers 文件）"></a>sudo 配置（sudoers 文件）</h4><p><strong>基础语法</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编辑 sudoers（必须用 visudo，会检查语法错误）</span></span><br><span class="line">sudo visudo</span><br></pre></td></tr></table></figure>

<p><strong>常见配置示例</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 允许 sudo 组的所有用户执行任何命令</span></span><br><span class="line">%sudo   ALL=(ALL:ALL) ALL</span><br><span class="line"><span class="comment">#  │     │   │   │    │</span></span><br><span class="line"><span class="comment">#  │     │   │   │    └─ 可执行的命令（ALL = 所有）</span></span><br><span class="line"><span class="comment">#  │     │   │   └─ 可切换到的组</span></span><br><span class="line"><span class="comment">#  │     │   └─ 可切换到的用户</span></span><br><span class="line"><span class="comment">#  │     └─ 可在哪些主机执行</span></span><br><span class="line"><span class="comment">#  └─ % 表示组名</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 允许 alice 执行特定命令（无需密码）</span></span><br><span class="line">alice   ALL=(ALL) NOPASSWD: /usr/bin/systemctl restart nginx</span><br><span class="line"><span class="comment">#       ↑ 重启 nginx 不需要输密码</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 允许 devops 组执行所有命令（无需密码）</span></span><br><span class="line">%devops ALL=(ALL) NOPASSWD: ALL</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 只允许 alice 重启特定服务</span></span><br><span class="line">alice   ALL=(ALL) /usr/bin/systemctl restart nginx, /usr/bin/systemctl reload nginx</span><br></pre></td></tr></table></figure>

<p><strong>安全建议</strong>：</p>
<ul>
<li>✅ 用 <code>visudo</code> 编辑（防止语法错误导致 sudo 失效）</li>
<li>✅ 最小权限：只给需要的命令权限（不要全部 NOPASSWD）</li>
<li>✅ 审计日志：sudo 操作会记录到 <code>/var/log/auth.log</code></li>
</ul>
<h3 id="3️⃣-服务管理：攻击面最小化"><a href="#3️⃣-服务管理：攻击面最小化" class="headerlink" title="3️⃣ 服务管理：攻击面最小化"></a>3️⃣ 服务管理：攻击面最小化</h3><h4 id="systemd-服务管理（现代-Linux）"><a href="#systemd-服务管理（现代-Linux）" class="headerlink" title="systemd 服务管理（现代 Linux）"></a>systemd 服务管理（现代 Linux）</h4><table>
<thead>
<tr>
<th>操作</th>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>列出所有服务</td>
<td><code>systemctl list-units --type=service</code></td>
<td>查看运行中的服务</td>
</tr>
<tr>
<td>启动服务</td>
<td><code>sudo systemctl start &lt;服务名&gt;</code></td>
<td><code>sudo systemctl start nginx</code></td>
</tr>
<tr>
<td>停止服务</td>
<td><code>sudo systemctl stop &lt;服务名&gt;</code></td>
<td><code>sudo systemctl stop apache2</code></td>
</tr>
<tr>
<td>重启服务</td>
<td><code>sudo systemctl restart &lt;服务名&gt;</code></td>
<td><code>sudo systemctl restart sshd</code></td>
</tr>
<tr>
<td>开机自启</td>
<td><code>sudo systemctl enable &lt;服务名&gt;</code></td>
<td><code>sudo systemctl enable nginx</code></td>
</tr>
<tr>
<td>禁止自启</td>
<td><code>sudo systemctl disable &lt;服务名&gt;</code></td>
<td><code>sudo systemctl disable bluetooth</code></td>
</tr>
<tr>
<td>查看服务状态</td>
<td><code>systemctl status &lt;服务名&gt;</code></td>
<td><code>systemctl status sshd</code></td>
</tr>
<tr>
<td>查看服务日志</td>
<td><code>journalctl -u &lt;服务名&gt;</code></td>
<td><code>journalctl -u sshd -n 50</code></td>
</tr>
</tbody></table>
<h4 id="监听端口排查（攻击面盘点）"><a href="#监听端口排查（攻击面盘点）" class="headerlink" title="监听端口排查（攻击面盘点）"></a>监听端口排查（攻击面盘点）</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看所有监听端口（推荐）</span></span><br><span class="line">sudo ss -lntup</span><br><span class="line"><span class="comment"># -l: listening（监听）</span></span><br><span class="line"><span class="comment"># -n: numeric（显示 IP 而不是域名）</span></span><br><span class="line"><span class="comment"># -t: TCP</span></span><br><span class="line"><span class="comment"># -u: UDP</span></span><br><span class="line"><span class="comment"># -p: process（显示进程名）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出示例：</span></span><br><span class="line"><span class="comment"># Netid  State   Local Address:Port   Process</span></span><br><span class="line"><span class="comment"># tcp    LISTEN  0.0.0.0:22            users:((&quot;sshd&quot;,pid=1234))</span></span><br><span class="line"><span class="comment"># tcp    LISTEN  0.0.0.0:80            users:((&quot;nginx&quot;,pid=5678))</span></span><br><span class="line"><span class="comment"># tcp    LISTEN  127.0.0.1:3306        users:((&quot;mysqld&quot;,pid=9012))</span></span><br><span class="line"><span class="comment">#        ↑                              ↑</span></span><br><span class="line"><span class="comment">#     监听所有接口                   只监听本地</span></span><br></pre></td></tr></table></figure>

<p><strong>常见端口与风险</strong>：</p>
<table>
<thead>
<tr>
<th>端口</th>
<th>服务</th>
<th>风险</th>
<th>建议</th>
</tr>
</thead>
<tbody><tr>
<td><strong>22</strong></td>
<td>SSH</td>
<td>暴力破解、弱密码</td>
<td>改端口、密钥认证、禁止 root 登录</td>
</tr>
<tr>
<td><strong>80&#x2F;443</strong></td>
<td>HTTP&#x2F;HTTPS</td>
<td>Web 漏洞</td>
<td>及时更新、WAF、最小权限运行</td>
</tr>
<tr>
<td><strong>3306</strong></td>
<td>MySQL</td>
<td>数据库泄露</td>
<td><strong>只监听 127.0.0.1</strong>（不对外）</td>
</tr>
<tr>
<td><strong>5432</strong></td>
<td>PostgreSQL</td>
<td>数据库泄露</td>
<td>同上</td>
</tr>
<tr>
<td><strong>6379</strong></td>
<td>Redis</td>
<td>未授权访问</td>
<td>设置密码、绑定内网 IP</td>
</tr>
<tr>
<td><strong>3389</strong></td>
<td>RDP（Windows）</td>
<td>暴力破解</td>
<td>Linux 一般没有，如有则关闭</td>
</tr>
<tr>
<td><strong>445</strong></td>
<td>SMB</td>
<td>勒索病毒</td>
<td>Linux 一般没有，如有则关闭</td>
</tr>
</tbody></table>
<p><strong>最小暴露原则</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ✅ 好：数据库只监听本地（127.0.0.1:3306）</span></span><br><span class="line"><span class="comment"># ❌ 坏：数据库监听所有接口（0.0.0.0:3306）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查命令</span></span><br><span class="line">sudo ss -lntp | grep :3306</span><br><span class="line"><span class="comment"># 如果看到 0.0.0.0:3306 或 :::3306，说明对外暴露了！</span></span><br></pre></td></tr></table></figure>

<h3 id="4️⃣-日志审计：你的”黑匣子”"><a href="#4️⃣-日志审计：你的”黑匣子”" class="headerlink" title="4️⃣ 日志审计：你的”黑匣子”"></a>4️⃣ 日志审计：你的”黑匣子”</h3><h4 id="常见日志位置"><a href="#常见日志位置" class="headerlink" title="常见日志位置"></a>常见日志位置</h4><table>
<thead>
<tr>
<th>日志文件</th>
<th>内容</th>
<th>发行版</th>
</tr>
</thead>
<tbody><tr>
<td><code>/var/log/auth.log</code></td>
<td>认证日志（登录&#x2F;sudo&#x2F;su）</td>
<td>Debian&#x2F;Ubuntu</td>
</tr>
<tr>
<td><code>/var/log/secure</code></td>
<td>认证日志</td>
<td>RHEL&#x2F;CentOS</td>
</tr>
<tr>
<td><code>/var/log/syslog</code></td>
<td>系统日志</td>
<td>Debian&#x2F;Ubuntu</td>
</tr>
<tr>
<td><code>/var/log/messages</code></td>
<td>系统日志</td>
<td>RHEL&#x2F;CentOS</td>
</tr>
<tr>
<td><code>journalctl</code></td>
<td>systemd 日志（现代系统）</td>
<td>所有使用 systemd 的发行版</td>
</tr>
</tbody></table>
<h4 id="关键事件识别"><a href="#关键事件识别" class="headerlink" title="关键事件识别"></a>关键事件识别</h4><p><strong>1. SSH 登录成功</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看最近的 SSH 登录</span></span><br><span class="line">sudo journalctl -u sshd | grep <span class="string">&quot;Accepted&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例输出：</span></span><br><span class="line"><span class="comment"># Jan 08 10:23:45 server sshd[12345]: Accepted publickey for alice from 192.168.1.100 port 54321 ssh2: RSA SHA256:abc123...</span></span><br><span class="line"><span class="comment">#                                       ↑             ↑           ↑                   ↑</span></span><br><span class="line"><span class="comment">#                                    认证方式      用户名        来源IP              端口</span></span><br></pre></td></tr></table></figure>

<p><strong>2. SSH 登录失败（暴力破解线索）</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo journalctl -u sshd | grep <span class="string">&quot;Failed&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例输出：</span></span><br><span class="line"><span class="comment"># Jan 08 10:25:30 server sshd[12346]: Failed password for invalid user admin from 203.0.113.45 port 43210 ssh2</span></span><br><span class="line"><span class="comment">#                                                             ↑           ↑            ↑</span></span><br><span class="line"><span class="comment">#                                                         无效用户    用户名      攻击来源IP</span></span><br></pre></td></tr></table></figure>

<p><strong>3. sudo 使用记录</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo grep <span class="string">&quot;sudo&quot;</span> /var/log/auth.log | <span class="built_in">tail</span> -n 20</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例输出：</span></span><br><span class="line"><span class="comment"># Jan 08 10:30:00 server sudo: alice : TTY=pts/0 ; PWD=/home/alice ; USER=root ; COMMAND=/usr/bin/apt update</span></span><br><span class="line"><span class="comment">#                        ↑                                                ↑               ↑</span></span><br><span class="line"><span class="comment">#                    谁用 sudo                                        切换到谁        执行了什么命令</span></span><br></pre></td></tr></table></figure>

<p><strong>4. 用户创建&#x2F;删除</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo grep <span class="string">&quot;useradd\|userdel&quot;</span> /var/log/auth.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例输出：</span></span><br><span class="line"><span class="comment"># Jan 08 11:00:00 server useradd[12347]: new user: name=bob, UID=1001, GID=1001, home=/home/bob</span></span><br></pre></td></tr></table></figure>

<h4 id="journalctl-高级用法"><a href="#journalctl-高级用法" class="headerlink" title="journalctl 高级用法"></a>journalctl 高级用法</h4><table>
<thead>
<tr>
<th>用途</th>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>查看某服务日志</td>
<td><code>journalctl -u sshd</code></td>
<td>只看 sshd 服务</td>
</tr>
<tr>
<td>查看最近 N 行</td>
<td><code>journalctl -n 50</code></td>
<td>最近 50 行</td>
</tr>
<tr>
<td>实时查看</td>
<td><code>journalctl -f</code></td>
<td>类似 <code>tail -f</code></td>
</tr>
<tr>
<td>按时间筛选</td>
<td><code>journalctl --since &quot;2026-01-08 10:00&quot;</code></td>
<td>10点后的日志</td>
</tr>
<tr>
<td>按优先级筛选</td>
<td><code>journalctl -p err</code></td>
<td>只看错误级别</td>
</tr>
<tr>
<td>查看启动日志</td>
<td><code>journalctl -b</code></td>
<td>本次启动的日志</td>
</tr>
</tbody></table>
<h3 id="5️⃣-防火墙基础：iptables-vs-firewalld-vs-ufw"><a href="#5️⃣-防火墙基础：iptables-vs-firewalld-vs-ufw" class="headerlink" title="5️⃣ 防火墙基础：iptables vs firewalld vs ufw"></a>5️⃣ 防火墙基础：iptables vs firewalld vs ufw</h3><table>
<thead>
<tr>
<th>防火墙</th>
<th>发行版</th>
<th>特点</th>
<th>学习曲线</th>
</tr>
</thead>
<tbody><tr>
<td><strong>iptables</strong></td>
<td>通用</td>
<td>底层、强大、复杂</td>
<td>陡峭</td>
</tr>
<tr>
<td><strong>firewalld</strong></td>
<td>RHEL&#x2F;CentOS</td>
<td>动态规则、区域管理</td>
<td>中等</td>
</tr>
<tr>
<td><strong>ufw</strong></td>
<td>Ubuntu</td>
<td>简化版 iptables，易用</td>
<td>平缓</td>
</tr>
</tbody></table>
<h4 id="ufw-快速入门（Ubuntu-推荐）"><a href="#ufw-快速入门（Ubuntu-推荐）" class="headerlink" title="ufw 快速入门（Ubuntu 推荐）"></a>ufw 快速入门（Ubuntu 推荐）</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 启用防火墙</span></span><br><span class="line">sudo ufw <span class="built_in">enable</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 查看状态</span></span><br><span class="line">sudo ufw status</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 允许特定端口</span></span><br><span class="line">sudo ufw allow 22/tcp    <span class="comment"># SSH</span></span><br><span class="line">sudo ufw allow 80/tcp    <span class="comment"># HTTP</span></span><br><span class="line">sudo ufw allow 443/tcp   <span class="comment"># HTTPS</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 允许特定 IP 访问特定端口</span></span><br><span class="line">sudo ufw allow from 192.168.1.0/24 to any port 22</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 拒绝特定端口</span></span><br><span class="line">sudo ufw deny 3306/tcp   <span class="comment"># MySQL</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. 删除规则</span></span><br><span class="line">sudo ufw delete allow 80/tcp</span><br><span class="line"></span><br><span class="line"><span class="comment"># 7. 重置所有规则</span></span><br><span class="line">sudo ufw reset</span><br></pre></td></tr></table></figure>

<h2 id="实践任务（合法授权范围内）"><a href="#实践任务（合法授权范围内）" class="headerlink" title="实践任务（合法授权范围内）"></a>实践任务（合法授权范围内）</h2><blockquote>
<p>⚠️ <strong>重要提醒</strong>：所有操作只在<strong>自建&#x2F;明确授权</strong>的 Linux 环境执行！</p>
</blockquote>
<h3 id="任务-0（准备环境，三选一）"><a href="#任务-0（准备环境，三选一）" class="headerlink" title="任务 0（准备环境，三选一）"></a>任务 0（准备环境，三选一）</h3><table>
<thead>
<tr>
<th>方案</th>
<th>难度</th>
<th>成本</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><strong>A. WSL</strong></td>
<td>⭐</td>
<td>免费</td>
<td>Windows 10&#x2F;11 自带，适合学习</td>
</tr>
<tr>
<td><strong>B. VirtualBox&#x2F;VMware</strong></td>
<td>⭐⭐</td>
<td>免费</td>
<td>需要下载 ISO（推荐 Ubuntu 22.04 LTS）</td>
</tr>
<tr>
<td><strong>C. 云主机</strong></td>
<td>⭐⭐⭐</td>
<td>按量付费</td>
<td>AWS&#x2F;阿里云轻量服务器（注意关机节约成本）</td>
</tr>
</tbody></table>
<p><strong>WSL 快速安装</strong>（推荐）：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows PowerShell（管理员）</span></span><br><span class="line">wsl <span class="literal">--install</span> <span class="literal">-d</span> Ubuntu<span class="literal">-22</span>.<span class="number">04</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装完成后，设置用户名和密码</span></span><br><span class="line"><span class="comment"># 进入 WSL：直接在命令行输入 `wsl` 或 `ubuntu`</span></span><br></pre></td></tr></table></figure>

<h3 id="任务-1（必做）：文件权限识别与转换"><a href="#任务-1（必做）：文件权限识别与转换" class="headerlink" title="任务 1（必做）：文件权限识别与转换"></a>任务 1（必做）：文件权限识别与转换</h3><h4 id="步骤-1：查看敏感文件权限"><a href="#步骤-1：查看敏感文件权限" class="headerlink" title="步骤 1：查看敏感文件权限"></a>步骤 1：查看敏感文件权限</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看 /etc/passwd（用户信息）</span></span><br><span class="line"><span class="built_in">ls</span> -l /etc/passwd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看 /etc/shadow（密码哈希）</span></span><br><span class="line"><span class="built_in">ls</span> -l /etc/shadow</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看 SSH 私钥（如果有）</span></span><br><span class="line"><span class="built_in">ls</span> -l ~/.ssh/id_* 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p><strong>你要记录的内容</strong>：</p>
<table>
<thead>
<tr>
<th>文件</th>
<th>权限（符号）</th>
<th>权限（数字）</th>
<th>所有者</th>
<th>所属组</th>
<th>为什么这样设置？</th>
</tr>
</thead>
<tbody><tr>
<td><code>/etc/passwd</code></td>
<td><code>-rw-r--r--</code></td>
<td>644</td>
<td>root</td>
<td>root</td>
<td>用户信息公开可读，但只有 root 可写</td>
</tr>
<tr>
<td><code>/etc/shadow</code></td>
<td><code>-rw-r-----</code></td>
<td>640</td>
<td>root</td>
<td>shadow</td>
<td>密码哈希敏感，只有 root 和 shadow 组可读</td>
</tr>
<tr>
<td><code>~/.ssh/id_rsa</code></td>
<td><code>-rw-------</code></td>
<td>600</td>
<td>alice</td>
<td>alice</td>
<td>SSH 私钥必须只有 owner 可读写</td>
</tr>
</tbody></table>
<h4 id="步骤-2：权限计算练习"><a href="#步骤-2：权限计算练习" class="headerlink" title="步骤 2：权限计算练习"></a>步骤 2：权限计算练习</h4><p>手动计算以下权限：</p>
<ol>
<li><code>-rwxr-x---</code> &#x3D; ?</li>
<li><code>-rw-rw-r--</code> &#x3D; ?</li>
<li><code>drwx------</code> &#x3D; ?</li>
</ol>
<details>
<summary>答案</summary>

<ol>
<li><code>750</code>（owner&#x3D;7, group&#x3D;5, others&#x3D;0）</li>
<li><code>664</code>（owner&#x3D;6, group&#x3D;6, others&#x3D;4）</li>
<li><code>700</code>（目录，owner&#x3D;7, group&#x3D;0, others&#x3D;0）</details></li>
</ol>
<h3 id="任务-2（必做）：创建用户并配置-sudo"><a href="#任务-2（必做）：创建用户并配置-sudo" class="headerlink" title="任务 2（必做）：创建用户并配置 sudo"></a>任务 2（必做）：创建用户并配置 sudo</h3><h4 id="步骤-1：创建新用户"><a href="#步骤-1：创建新用户" class="headerlink" title="步骤 1：创建新用户"></a>步骤 1：创建新用户</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建用户（-m 创建主目录）</span></span><br><span class="line">sudo useradd -m -s /bin/bash alice</span><br><span class="line"><span class="comment">#            │  │</span></span><br><span class="line"><span class="comment">#            │  └─ 指定默认 shell</span></span><br><span class="line"><span class="comment">#            └─ 创建 /home/alice</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置密码</span></span><br><span class="line">sudo passwd alice</span><br><span class="line"><span class="comment"># 输入两次密码（建议：P@ssw0rd!123）</span></span><br></pre></td></tr></table></figure>

<h4 id="步骤-2：将用户加入-sudo-组"><a href="#步骤-2：将用户加入-sudo-组" class="headerlink" title="步骤 2：将用户加入 sudo 组"></a>步骤 2：将用户加入 sudo 组</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Ubuntu/Debian</span></span><br><span class="line">sudo usermod -aG sudo alice</span><br><span class="line"></span><br><span class="line"><span class="comment"># RHEL/CentOS</span></span><br><span class="line">sudo usermod -aG wheel alice</span><br></pre></td></tr></table></figure>

<h4 id="步骤-3：验证配置"><a href="#步骤-3：验证配置" class="headerlink" title="步骤 3：验证配置"></a>步骤 3：验证配置</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看用户信息</span></span><br><span class="line"><span class="built_in">id</span> alice</span><br><span class="line"><span class="comment"># 输出应包含：groups=...,27(sudo),...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换到新用户测试 sudo</span></span><br><span class="line">su - alice</span><br><span class="line"><span class="comment"># 输入 alice 的密码</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试 sudo</span></span><br><span class="line">sudo <span class="built_in">whoami</span></span><br><span class="line"><span class="comment"># 输入 alice 的密码</span></span><br><span class="line"><span class="comment"># 输出：root（说明 sudo 生效）</span></span><br></pre></td></tr></table></figure>

<p><strong>你要提交的证据</strong>：</p>
<ul>
<li><input disabled="" type="checkbox"> <code>id alice</code> 的输出截图（能看到 sudo 组）</li>
<li><input disabled="" type="checkbox"> <code>sudo whoami</code> 的输出（显示 root）</li>
</ul>
<h3 id="任务-3（必做）：盘点监听端口（攻击面评估）"><a href="#任务-3（必做）：盘点监听端口（攻击面评估）" class="headerlink" title="任务 3（必做）：盘点监听端口（攻击面评估）"></a>任务 3（必做）：盘点监听端口（攻击面评估）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看所有监听端口</span></span><br><span class="line">sudo ss -lntup | column -t</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者用更详细的输出</span></span><br><span class="line">sudo ss -lntup | awk <span class="string">&#x27;NR==1 || /LISTEN/ &#123;print $0&#125;&#x27;</span> | column -t</span><br></pre></td></tr></table></figure>

<p><strong>你要分析的内容</strong>：</p>
<table>
<thead>
<tr>
<th>端口</th>
<th>协议</th>
<th>进程名</th>
<th>监听地址</th>
<th>是否需要对外？</th>
<th>风险评估</th>
</tr>
</thead>
<tbody><tr>
<td>22</td>
<td>TCP</td>
<td>sshd</td>
<td>0.0.0.0</td>
<td>✅ 是（远程管理）</td>
<td>高（改端口&#x2F;密钥认证）</td>
</tr>
<tr>
<td>80</td>
<td>TCP</td>
<td>nginx</td>
<td>0.0.0.0</td>
<td>✅ 是（Web 服务）</td>
<td>中（及时更新）</td>
</tr>
<tr>
<td>3306</td>
<td>TCP</td>
<td>mysqld</td>
<td><strong>0.0.0.0</strong></td>
<td>❌ 否（应该 127.0.0.1）</td>
<td><strong>高风险！</strong></td>
</tr>
</tbody></table>
<p><strong>修复示例</strong>（MySQL 只监听本地）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编辑 MySQL 配置</span></span><br><span class="line">sudo nano /etc/mysql/mysql.conf.d/mysqld.cnf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 找到 bind-address 行，改为：</span></span><br><span class="line">bind-address = 127.0.0.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启 MySQL</span></span><br><span class="line">sudo systemctl restart mysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证</span></span><br><span class="line">sudo ss -lntp | grep :3306</span><br><span class="line"><span class="comment"># 应该看到 127.0.0.1:3306（不是 0.0.0.0）</span></span><br></pre></td></tr></table></figure>

<h3 id="任务-4（必做）：查看认证日志"><a href="#任务-4（必做）：查看认证日志" class="headerlink" title="任务 4（必做）：查看认证日志"></a>任务 4（必做）：查看认证日志</h3><h4 id="方案-A：journalctl（推荐）"><a href="#方案-A：journalctl（推荐）" class="headerlink" title="方案 A：journalctl（推荐）"></a>方案 A：journalctl（推荐）</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看 SSH 服务日志（最近 50 行）</span></span><br><span class="line">sudo journalctl -u ssh -n 50 --no-pager</span><br><span class="line"></span><br><span class="line"><span class="comment"># 筛选登录成功事件</span></span><br><span class="line">sudo journalctl -u ssh | grep <span class="string">&quot;Accepted&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 筛选登录失败事件</span></span><br><span class="line">sudo journalctl -u ssh | grep <span class="string">&quot;Failed&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看今天的 sudo 使用记录</span></span><br><span class="line">sudo journalctl --since today | grep sudo</span><br></pre></td></tr></table></figure>

<h4 id="方案-B：传统日志文件"><a href="#方案-B：传统日志文件" class="headerlink" title="方案 B：传统日志文件"></a>方案 B：传统日志文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Ubuntu/Debian</span></span><br><span class="line">sudo <span class="built_in">tail</span> -n 50 /var/log/auth.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># RHEL/CentOS</span></span><br><span class="line">sudo <span class="built_in">tail</span> -n 50 /var/log/secure</span><br><span class="line"></span><br><span class="line"><span class="comment"># 筛选 SSH 登录</span></span><br><span class="line">sudo grep <span class="string">&quot;sshd.*Accepted&quot;</span> /var/log/auth.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># 筛选 sudo 使用</span></span><br><span class="line">sudo grep <span class="string">&quot;sudo.*COMMAND&quot;</span> /var/log/auth.log</span><br></pre></td></tr></table></figure>

<p><strong>你要提取的信息</strong>：</p>
<ol>
<li><p><strong>最近一次成功登录</strong>：</p>
<ul>
<li>用户名：</li>
<li>来源 IP：</li>
<li>认证方式（password&#x2F;publickey）：</li>
<li>时间：</li>
</ul>
</li>
<li><p><strong>最近一次 sudo 使用</strong>：</p>
<ul>
<li>用户名：</li>
<li>执行的命令：</li>
<li>时间：</li>
</ul>
</li>
<li><p><strong>异常事件</strong>（如果有）：</p>
<ul>
<li>失败登录次数：</li>
<li>来源 IP（是否陌生）：</li>
</ul>
</li>
</ol>
<h3 id="任务-5（可选）：配置-ufw-防火墙"><a href="#任务-5（可选）：配置-ufw-防火墙" class="headerlink" title="任务 5（可选）：配置 ufw 防火墙"></a>任务 5（可选）：配置 ufw 防火墙</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 安装 ufw（Ubuntu 一般自带）</span></span><br><span class="line">sudo apt install ufw</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 查看当前状态</span></span><br><span class="line">sudo ufw status verbose</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 设置默认策略（拒绝所有入站，允许所有出站）</span></span><br><span class="line">sudo ufw default deny incoming</span><br><span class="line">sudo ufw default allow outgoing</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 允许 SSH（⚠️ 先允许 SSH，否则会把自己锁死！）</span></span><br><span class="line">sudo ufw allow 22/tcp</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 启用防火墙</span></span><br><span class="line">sudo ufw <span class="built_in">enable</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. 验证规则</span></span><br><span class="line">sudo ufw status numbered</span><br></pre></td></tr></table></figure>

<p><strong>扩展练习</strong>：</p>
<ul>
<li>只允许特定 IP 段访问 SSH：<code>sudo ufw allow from 192.168.1.0/24 to any port 22</code></li>
<li>允许 HTTP&#x2F;HTTPS：<code>sudo ufw allow 80/tcp; sudo ufw allow 443/tcp</code></li>
<li>拒绝特定 IP：<code>sudo ufw deny from 203.0.113.45</code></li>
</ul>
<h2 id="巩固练习（题与复盘）"><a href="#巩固练习（题与复盘）" class="headerlink" title="巩固练习（题与复盘）"></a>巩固练习（题与复盘）</h2><h3 id="题-1：权限转换（必做）"><a href="#题-1：权限转换（必做）" class="headerlink" title="题 1：权限转换（必做）"></a>题 1：权限转换（必做）</h3><p>将以下权限互相转换：</p>
<table>
<thead>
<tr>
<th>符号表示</th>
<th>数字表示</th>
</tr>
</thead>
<tbody><tr>
<td><code>-rwxr-xr-x</code></td>
<td>?</td>
</tr>
<tr>
<td><code>-rw-r-----</code></td>
<td>?</td>
</tr>
<tr>
<td><code>drwx------</code></td>
<td>?</td>
</tr>
<tr>
<td><code>?</code></td>
<td>644</td>
</tr>
<tr>
<td><code>?</code></td>
<td>750</td>
</tr>
<tr>
<td><code>?</code></td>
<td>600</td>
</tr>
</tbody></table>
<h3 id="题-2：安全场景判断（必做）"><a href="#题-2：安全场景判断（必做）" class="headerlink" title="题 2：安全场景判断（必做）"></a>题 2：安全场景判断（必做）</h3><p>判断以下配置是否安全，如果不安全，写出正确配置：</p>
<ol>
<li><code>/etc/shadow</code> 权限是 <code>644</code></li>
<li>SSH 私钥 <code>~/.ssh/id_rsa</code> 权限是 <code>644</code></li>
<li>MySQL 监听 <code>0.0.0.0:3306</code></li>
<li>所有用户都在 sudoers 中配置了 <code>NOPASSWD: ALL</code></li>
<li>SSH 配置 <code>PermitRootLogin yes</code></li>
</ol>
<h3 id="题-3：写一份-Linux-加固清单（10-条以上）"><a href="#题-3：写一份-Linux-加固清单（10-条以上）" class="headerlink" title="题 3：写一份 Linux 加固清单（10 条以上）"></a>题 3：写一份 Linux 加固清单（10 条以上）</h3><p>从以下角度写：账号管理、权限控制、服务管理、网络安全、日志审计。</p>
<h3 id="题-4（进阶）：设计一个-sudo-权限方案"><a href="#题-4（进阶）：设计一个-sudo-权限方案" class="headerlink" title="题 4（进阶）：设计一个 sudo 权限方案"></a>题 4（进阶）：设计一个 sudo 权限方案</h3><p>场景：你的团队有 3 类人员：</p>
<ul>
<li><strong>开发人员</strong>（developers）：需要重启 Web 服务（nginx&#x2F;apache2）</li>
<li><strong>DBA</strong>（dba）：需要重启数据库服务（mysql&#x2F;postgresql）</li>
<li><strong>运维人员</strong>（ops）：需要所有权限</li>
</ul>
<p>写出 sudoers 配置。</p>
<h2 id="评估标准（达成判定）"><a href="#评估标准（达成判定）" class="headerlink" title="评估标准（达成判定）"></a>评估标准（达成判定）</h2><table>
<thead>
<tr>
<th>评估项</th>
<th>达成标准</th>
<th>检查方法</th>
</tr>
</thead>
<tbody><tr>
<td><strong>权限理解</strong></td>
<td>能正确转换 rwx ↔ 数字（至少 3 个例子）</td>
<td>检查题 1 答案</td>
</tr>
<tr>
<td><strong>用户管理</strong></td>
<td>成功创建用户并配置 sudo</td>
<td>检查任务 2 截图</td>
</tr>
<tr>
<td><strong>攻击面盘点</strong></td>
<td>输出监听端口清单并评估风险</td>
<td>检查任务 3 分析表</td>
</tr>
<tr>
<td><strong>日志审计</strong></td>
<td>能找到 SSH 登录&#x2F;sudo 使用记录</td>
<td>检查任务 4 提取信息</td>
</tr>
<tr>
<td><strong>加固意识</strong></td>
<td>输出 10+ 条加固清单</td>
<td>检查题 3 清单</td>
</tr>
</tbody></table>
<p><strong>达成判定</strong>：</p>
<ul>
<li>✅ <strong>优秀</strong>（5&#x2F;5）：完成所有任务 + 题 1-4 全部完成 + 清单 15+ 条</li>
<li>✅ <strong>良好</strong>（4&#x2F;5）：完成 4 个必做任务 + 题 1-3 完成 + 清单 10+ 条</li>
<li>✅ <strong>合格</strong>（3&#x2F;5）：完成 3 个必做任务 + 题 1-2 完成 + 清单 5+ 条</li>
</ul>
<h2 id="学习成果达成情况（由学习者填写）"><a href="#学习成果达成情况（由学习者填写）" class="headerlink" title="学习成果达成情况（由学习者填写）"></a>学习成果达成情况（由学习者填写）</h2><h3 id="截图与证据"><a href="#截图与证据" class="headerlink" title="截图与证据"></a>截图与证据</h3><ul>
<li><input disabled="" type="checkbox"> 任务 1：<code>ls -l /etc/shadow</code> 权限截图</li>
<li><input disabled="" type="checkbox"> 任务 2：<code>id alice</code> 输出截图（含 sudo 组）</li>
<li><input disabled="" type="checkbox"> 任务 2：<code>sudo whoami</code> 输出截图（显示 root）</li>
<li><input disabled="" type="checkbox"> 任务 3：<code>ss -lntup</code> 监听端口截图</li>
<li><input disabled="" type="checkbox"> 任务 4：<code>journalctl -u ssh | grep Accepted</code> 截图</li>
<li><input disabled="" type="checkbox"> 任务 5（可选）：<code>ufw status</code> 截图</li>
</ul>
<h3 id="关键命令与输出"><a href="#关键命令与输出" class="headerlink" title="关键命令与输出"></a>关键命令与输出</h3><p><strong>权限查看</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/etc/passwd: -rw-r--r-- (644)</span><br><span class="line">/etc/shadow: -rw-r----- (640)</span><br><span class="line">~/.ssh/id_rsa: -rw------- (600)</span><br></pre></td></tr></table></figure>

<p><strong>监听端口</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">端口 22: sshd (0.0.0.0) - 需要对外</span><br><span class="line">端口 80: nginx (0.0.0.0) - 需要对外</span><br><span class="line">端口 3306: mysqld (127.0.0.1) - 只监听本地 ✅</span><br></pre></td></tr></table></figure>

<p><strong>日志摘要</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">最近登录：alice from 192.168.1.100 (publickey)</span><br><span class="line">最近 sudo：alice executed /usr/bin/apt update</span><br></pre></td></tr></table></figure>

<h3 id="权限转换练习（题-1-答案）"><a href="#权限转换练习（题-1-答案）" class="headerlink" title="权限转换练习（题 1 答案）"></a>权限转换练习（题 1 答案）</h3><table>
<thead>
<tr>
<th>符号表示</th>
<th>数字表示</th>
</tr>
</thead>
<tbody><tr>
<td><code>-rwxr-xr-x</code></td>
<td><strong>755</strong></td>
</tr>
<tr>
<td><code>-rw-r-----</code></td>
<td><strong>640</strong></td>
</tr>
<tr>
<td><code>drwx------</code></td>
<td><strong>700</strong></td>
</tr>
<tr>
<td><code>-rw-r--r--</code></td>
<td><strong>644</strong></td>
</tr>
<tr>
<td><code>-rwxr-x---</code></td>
<td><strong>750</strong></td>
</tr>
<tr>
<td><code>-rw-------</code></td>
<td><strong>600</strong></td>
</tr>
</tbody></table>
<h3 id="安全场景判断（题-2-答案）"><a href="#安全场景判断（题-2-答案）" class="headerlink" title="安全场景判断（题 2 答案）"></a>安全场景判断（题 2 答案）</h3><ol>
<li><p>❌ <strong>不安全</strong>：<code>/etc/shadow</code> 权限 644</p>
<ul>
<li>✅ <strong>正确</strong>：应该是 640（<code>-rw-r-----</code>），只有 root 和 shadow 组可读</li>
<li><strong>原因</strong>：密码哈希敏感，所有用户可读会泄露</li>
</ul>
</li>
<li><p>❌ <strong>不安全</strong>：SSH 私钥权限 644</p>
<ul>
<li>✅ <strong>正确</strong>：应该是 600（<code>-rw-------</code>），只有 owner 可读写</li>
<li><strong>原因</strong>：SSH 会拒绝使用权限过宽的私钥</li>
</ul>
</li>
<li><p>❌ <strong>不安全</strong>：MySQL 监听 0.0.0.0:3306</p>
<ul>
<li>✅ <strong>正确</strong>：应该监听 127.0.0.1:3306（只本地访问）</li>
<li><strong>修复</strong>：编辑 <code>/etc/mysql/mysql.conf.d/mysqld.cnf</code>，设置 <code>bind-address = 127.0.0.1</code></li>
</ul>
</li>
<li><p>❌ <strong>不安全</strong>：所有用户 <code>NOPASSWD: ALL</code></p>
<ul>
<li>✅ <strong>正确</strong>：最小权限原则，只给需要的命令权限</li>
<li><strong>示例</strong>：<code>alice ALL=(ALL) /usr/bin/systemctl restart nginx</code></li>
</ul>
</li>
<li><p>❌ <strong>不安全</strong>：SSH 配置 <code>PermitRootLogin yes</code></p>
<ul>
<li>✅ <strong>正确</strong>：应该设置为 <code>PermitRootLogin no</code></li>
<li><strong>修复</strong>：编辑 <code>/etc/ssh/sshd_config</code>，重启 sshd</li>
</ul>
</li>
</ol>
<h3 id="Linux-加固清单（题-3-答案）"><a href="#Linux-加固清单（题-3-答案）" class="headerlink" title="Linux 加固清单（题 3 答案）"></a>Linux 加固清单（题 3 答案）</h3><h4 id="账号管理（5-条）"><a href="#账号管理（5-条）" class="headerlink" title="账号管理（5 条）"></a>账号管理（5 条）</h4><ol>
<li>✅ <strong>禁止 root 远程登录</strong>：<code>PermitRootLogin no</code> in <code>/etc/ssh/sshd_config</code></li>
<li>✅ <strong>使用密钥认证</strong>：禁用密码登录（<code>PasswordAuthentication no</code>）</li>
<li>✅ <strong>定期审计用户</strong>：删除不再需要的账号（<code>userdel -r &lt;user&gt;</code>）</li>
<li>✅ <strong>强制密码策略</strong>：安装 <code>libpam-pwquality</code>，配置最小长度&#x2F;复杂度</li>
<li>✅ <strong>锁定长期未登录账号</strong>：<code>usermod -L &lt;user&gt;</code>（锁定）或删除</li>
</ol>
<h4 id="权限控制（3-条）"><a href="#权限控制（3-条）" class="headerlink" title="权限控制（3 条）"></a>权限控制（3 条）</h4><ol start="6">
<li>✅ <strong>敏感文件权限</strong>：<ul>
<li><code>/etc/shadow</code>: 640</li>
<li><code>~/.ssh/id_*</code>: 600</li>
<li><code>/etc/sudoers</code>: 440</li>
</ul>
</li>
<li>✅ <strong>定期检查 SUID 文件</strong>：<code>find / -perm -4000 -type f 2&gt;/dev/null</code></li>
<li>✅ <strong>sudo 最小权限</strong>：不要用 <code>NOPASSWD: ALL</code>，精确到具体命令</li>
</ol>
<h4 id="服务管理（3-条）"><a href="#服务管理（3-条）" class="headerlink" title="服务管理（3 条）"></a>服务管理（3 条）</h4><ol start="9">
<li>✅ <strong>关闭不需要的服务</strong>：<code>systemctl disable &lt;service&gt;</code></li>
<li>✅ <strong>最小暴露原则</strong>：数据库只监听 127.0.0.1</li>
<li>✅ <strong>及时更新补丁</strong>：<code>apt update &amp;&amp; apt upgrade</code>（或 <code>yum update</code>）</li>
</ol>
<h4 id="网络安全（4-条）"><a href="#网络安全（4-条）" class="headerlink" title="网络安全（4 条）"></a>网络安全（4 条）</h4><ol start="12">
<li>✅ <strong>配置防火墙</strong>：ufw&#x2F;firewalld，默认拒绝入站</li>
<li>✅ <strong>修改 SSH 默认端口</strong>：改为非 22 端口（如 2222）</li>
<li>✅ <strong>SSH 限制来源 IP</strong>：<code>AllowUsers alice@192.168.1.0/24</code></li>
<li>✅ <strong>安装 fail2ban</strong>：自动封禁暴力破解 IP</li>
</ol>
<h4 id="日志审计（3-条）"><a href="#日志审计（3-条）" class="headerlink" title="日志审计（3 条）"></a>日志审计（3 条）</h4><ol start="16">
<li>✅ <strong>集中日志管理</strong>：配置 rsyslog 发送到日志服务器</li>
<li>✅ <strong>定期检查日志</strong>：每天查看 <code>/var/log/auth.log</code> 是否有异常</li>
<li>✅ <strong>启用审计系统</strong>：安装 <code>auditd</code>，记录文件访问&#x2F;命令执行</li>
</ol>
<h3 id="sudo-权限方案（题-4-答案）"><a href="#sudo-权限方案（题-4-答案）" class="headerlink" title="sudo 权限方案（题 4 答案）"></a>sudo 权限方案（题 4 答案）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编辑 sudoers</span></span><br><span class="line">sudo visudo</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 开发人员组（只能重启 Web 服务）</span></span><br><span class="line">%developers ALL=(ALL) NOPASSWD: /usr/bin/systemctl restart nginx, \</span><br><span class="line">                                  /usr/bin/systemctl reload nginx, \</span><br><span class="line">                                  /usr/bin/systemctl restart apache2, \</span><br><span class="line">                                  /usr/bin/systemctl reload apache2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. DBA 组（只能管理数据库服务）</span></span><br><span class="line">%dba ALL=(ALL) NOPASSWD: /usr/bin/systemctl restart mysql, \</span><br><span class="line">                          /usr/bin/systemctl restart postgresql, \</span><br><span class="line">                          /usr/bin/systemctl status mysql, \</span><br><span class="line">                          /usr/bin/systemctl status postgresql</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 运维人员组（所有权限，但需要密码）</span></span><br><span class="line">%ops ALL=(ALL) ALL</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 审计（可选）：记录所有 sudo 命令到单独日志</span></span><br><span class="line">Defaults logfile=<span class="string">&quot;/var/log/sudo.log&quot;</span></span><br><span class="line">Defaults log_input, log_output</span><br></pre></td></tr></table></figure>

<p><strong>安全要点</strong>：</p>
<ul>
<li>开发&#x2F;DBA 用 <code>NOPASSWD</code>（频繁操作，但范围受限）</li>
<li>运维需要密码（权限大，增加一层验证）</li>
<li>所有 sudo 操作都会记录到日志</li>
</ul>
<h3 id="结论与反思"><a href="#结论与反思" class="headerlink" title="结论与反思"></a>结论与反思</h3><p><strong>我今天搞清楚了</strong>：</p>
<ul>
<li>Linux 权限模型：3 类人（owner&#x2F;group&#x2F;others）× 3 种权限（rwx）&#x3D; 9 位权限位</li>
<li>权限数字表示：r&#x3D;4, w&#x3D;2, x&#x3D;1，快速计算（如 644 &#x3D; rw-r–r–）</li>
<li>特殊权限：SUID&#x2F;SGID&#x2F;Sticky Bit 的作用与风险</li>
<li>sudo 配置：最小权限原则，不要滥用 <code>NOPASSWD: ALL</code></li>
<li>攻击面盘点：用 <code>ss -lntup</code> 查看监听端口，数据库不要监听 0.0.0.0</li>
<li>日志审计：journalctl 查看 SSH 登录&#x2F;sudo 使用记录</li>
</ul>
<p><strong>我差点搞混的是</strong>：</p>
<ul>
<li>以为 <code>/etc/shadow</code> 权限 644 没问题（其实应该是 640）</li>
<li>以为 SSH 私钥权限 644 可以用（SSH 会拒绝权限过宽的私钥）</li>
<li>以为 MySQL 监听 0.0.0.0 没关系（其实应该只监听 127.0.0.1）</li>
</ul>
<p><strong>明天我要继续补的是</strong>：</p>
<ul>
<li>Windows 安全基础（UAC、事件日志、防火墙）</li>
<li>PowerShell 脚本自动化（日志分析、CSV 导出）</li>
<li>实际搭建一个 fail2ban 防暴力破解</li>
</ul>
<p><strong>本次学习耗时</strong>：约 ___ 小时</p>
<p><strong>掌握程度自评</strong>：</p>
<ul>
<li><input disabled="" type="checkbox"> 😕 只看懂了概念，没动手</li>
<li><input disabled="" type="checkbox"> 🙂 完成了部分任务（WSL 环境搭建成功）</li>
<li><input disabled="" type="checkbox"> 😃 完成了所有必做任务并理解原理</li>
<li><input disabled="" type="checkbox"> 🤩 额外研究了 SELinux&#x2F;AppArmor&#x2F;auditd</li>
</ul>
<h2 id="集中参考答案（含思路）"><a href="#集中参考答案（含思路）" class="headerlink" title="集中参考答案（含思路）"></a>集中参考答案（含思路）</h2><h3 id="题-1-参考答案（权限转换）"><a href="#题-1-参考答案（权限转换）" class="headerlink" title="题 1 参考答案（权限转换）"></a>题 1 参考答案（权限转换）</h3><p><strong>方法</strong>：每 3 位权限为一组，rwx 对应 421：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">-rwxr-xr-x</span><br><span class="line"> └┬┘└┬┘└┬┘</span><br><span class="line">  7  5  5  = 755</span><br><span class="line"></span><br><span class="line">-rw-r-----</span><br><span class="line"> └┬┘└┬┘└┬┘</span><br><span class="line">  6  4  0  = 640</span><br><span class="line"></span><br><span class="line">drwx------</span><br><span class="line"> └┬┘└┬┘└┬┘</span><br><span class="line">  7  0  0  = 700（d 表示目录）</span><br><span class="line"></span><br><span class="line">644 → rw-r--r-- (6=rw, 4=r, 4=r)</span><br><span class="line">750 → rwxr-x--- (7=rwx, 5=rx, 0=无)</span><br><span class="line">600 → rw------- (6=rw, 0=无, 0=无)</span><br></pre></td></tr></table></figure>

<h3 id="题-2-参考答案（详见上方”安全场景判断”）"><a href="#题-2-参考答案（详见上方”安全场景判断”）" class="headerlink" title="题 2 参考答案（详见上方”安全场景判断”）"></a>题 2 参考答案（详见上方”安全场景判断”）</h3><h3 id="题-3-参考答案（详见上方”Linux-加固清单”，共-18-条）"><a href="#题-3-参考答案（详见上方”Linux-加固清单”，共-18-条）" class="headerlink" title="题 3 参考答案（详见上方”Linux 加固清单”，共 18 条）"></a>题 3 参考答案（详见上方”Linux 加固清单”，共 18 条）</h3><h3 id="题-4-参考答案（详见上方”sudo-权限方案”）"><a href="#题-4-参考答案（详见上方”sudo-权限方案”）" class="headerlink" title="题 4 参考答案（详见上方”sudo 权限方案”）"></a>题 4 参考答案（详见上方”sudo 权限方案”）</h3><h2 id="学习成果示例填写（可照抄）"><a href="#学习成果示例填写（可照抄）" class="headerlink" title="学习成果示例填写（可照抄）"></a>学习成果示例填写（可照抄）</h2><h3 id="截图与证据（示例）"><a href="#截图与证据（示例）" class="headerlink" title="截图与证据（示例）"></a>截图与证据（示例）</h3><ul>
<li><code>images/day015_shadow_perm.png</code>：<code>/etc/shadow</code> 权限 <code>-rw-r-----</code> (640)</li>
<li><code>images/day015_user_sudo.png</code>：<code>id alice</code> 输出包含 <code>sudo</code> 组</li>
<li><code>images/day015_ports.png</code>：<code>ss -lntup</code> 显示端口 22&#x2F;80，MySQL 只监听 127.0.0.1</li>
<li><code>images/day015_ssh_log.png</code>：<code>journalctl -u ssh | grep Accepted</code> 显示登录记录</li>
</ul>
<h3 id="关键命令与输出（示例）"><a href="#关键命令与输出（示例）" class="headerlink" title="关键命令与输出（示例）"></a>关键命令与输出（示例）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 权限查看</span></span><br><span class="line">-rw-r--r-- 1 root root 2847 /etc/passwd  (644)</span><br><span class="line">-rw-r----- 1 root shadow 1234 /etc/shadow  (640)</span><br><span class="line">-rw------- 1 alice alice 1679 /home/alice/.ssh/id_rsa  (600)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 监听端口</span></span><br><span class="line">tcp LISTEN 0.0.0.0:22 sshd</span><br><span class="line">tcp LISTEN 0.0.0.0:80 nginx</span><br><span class="line">tcp LISTEN 127.0.0.1:3306 mysqld  ✅ 只监听本地</span><br><span class="line"></span><br><span class="line"><span class="comment"># 日志摘要</span></span><br><span class="line">Accepted publickey <span class="keyword">for</span> alice from 192.168.1.100 port 54321</span><br><span class="line">sudo: alice : COMMAND=/usr/bin/apt update</span><br></pre></td></tr></table></figure>

<h3 id="反思（示例）"><a href="#反思（示例）" class="headerlink" title="反思（示例）"></a>反思（示例）</h3><ul>
<li>我以前装完 Linux 就不管了，现在知道要盘点监听端口、检查权限、看日志。</li>
<li>下次我会先建普通用户 + sudo，再考虑禁止 root 登录，避免把自己锁死。</li>
<li>最大收获：<strong>攻击面最小化</strong> &#x3D; 关闭不需要的服务 + 数据库只监听本地 + 防火墙默认拒绝。</li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag"># 网络</a>
              <a href="/tags/%E5%AE%89%E5%85%A8/" rel="tag"># 安全</a>
              <a href="/tags/%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/" rel="tag"># 学习计划</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/post/b2632e05.html" rel="prev" title="Day014：安全协议与加密 - 第 2 周综合实验与测评">
                  <i class="fa fa-chevron-left"></i> Day014：安全协议与加密 - 第 2 周综合实验与测评
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/post/f97e6e0d.html" rel="next" title="Day016：操作系统与脚本 - Windows 安全基础">
                  Day016：操作系统与脚本 - Windows 安全基础 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="lv-container" data-id="city" data-uid="MTAyMC8zNDY4NC8xMTIyMQ=="></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2026</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Tigercoll</span>
</div>
<!-- 网站运行时间的设置 -->
<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("04/21/2019 15:54:40");//此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "等待与你相遇的 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
    }
setInterval("createtime()",250);
</script>
<!--
-->

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  




<script src="/js/third-party/comments/livere.js"></script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
